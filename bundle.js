!function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:i})},n.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=1)}([function(t,e,n){var i;i=function(){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:i})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=4)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.setMatrixArrayType=function(t){e.ARRAY_TYPE=t},e.toRadian=function(t){return t*r},e.equals=function(t,e){return Math.abs(t-e)<=i*Math.max(1,Math.abs(t),Math.abs(e))};var i=e.EPSILON=1e-6;e.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,e.RANDOM=Math.random;var r=Math.PI/180},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.sub=e.mul=void 0,e.create=function(){var t=new i.ARRAY_TYPE(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},e.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},e.clone=function(t){var e=new i.ARRAY_TYPE(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},e.fromValues=function(t,e,n,r,s,o,a,h,u){var c=new i.ARRAY_TYPE(9);return c[0]=t,c[1]=e,c[2]=n,c[3]=r,c[4]=s,c[5]=o,c[6]=a,c[7]=h,c[8]=u,c},e.set=function(t,e,n,i,r,s,o,a,h,u){return t[0]=e,t[1]=n,t[2]=i,t[3]=r,t[4]=s,t[5]=o,t[6]=a,t[7]=h,t[8]=u,t},e.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},e.transpose=function(t,e){if(t===e){var n=e[1],i=e[2],r=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=i,t[7]=r}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},e.invert=function(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],h=e[6],u=e[7],c=e[8],l=c*o-a*u,d=-c*s+a*h,f=u*s-o*h,p=n*l+i*d+r*f;if(!p)return null;return p=1/p,t[0]=l*p,t[1]=(-c*i+r*u)*p,t[2]=(a*i-r*o)*p,t[3]=d*p,t[4]=(c*n-r*h)*p,t[5]=(-a*n+r*s)*p,t[6]=f*p,t[7]=(-u*n+i*h)*p,t[8]=(o*n-i*s)*p,t},e.adjoint=function(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],h=e[6],u=e[7],c=e[8];return t[0]=o*c-a*u,t[1]=r*u-i*c,t[2]=i*a-r*o,t[3]=a*h-s*c,t[4]=n*c-r*h,t[5]=r*s-n*a,t[6]=s*u-o*h,t[7]=i*h-n*u,t[8]=n*o-i*s,t},e.determinant=function(t){var e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],o=t[5],a=t[6],h=t[7],u=t[8];return e*(u*s-o*h)+n*(-u*r+o*a)+i*(h*r-s*a)},e.multiply=r,e.translate=function(t,e,n){var i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],h=e[5],u=e[6],c=e[7],l=e[8],d=n[0],f=n[1];return t[0]=i,t[1]=r,t[2]=s,t[3]=o,t[4]=a,t[5]=h,t[6]=d*i+f*o+u,t[7]=d*r+f*a+c,t[8]=d*s+f*h+l,t},e.rotate=function(t,e,n){var i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],h=e[5],u=e[6],c=e[7],l=e[8],d=Math.sin(n),f=Math.cos(n);return t[0]=f*i+d*o,t[1]=f*r+d*a,t[2]=f*s+d*h,t[3]=f*o-d*i,t[4]=f*a-d*r,t[5]=f*h-d*s,t[6]=u,t[7]=c,t[8]=l,t},e.scale=function(t,e,n){var i=n[0],r=n[1];return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=r*e[3],t[4]=r*e[4],t[5]=r*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},e.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t},e.fromRotation=function(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=n,t[2]=0,t[3]=-n,t[4]=i,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},e.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},e.fromMat2d=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},e.fromQuat=function(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],o=n+n,a=i+i,h=r+r,u=n*o,c=i*o,l=i*a,d=r*o,f=r*a,p=r*h,m=s*o,v=s*a,M=s*h;return t[0]=1-l-p,t[3]=c-M,t[6]=d+v,t[1]=c+M,t[4]=1-u-p,t[7]=f-m,t[2]=d-v,t[5]=f+m,t[8]=1-u-l,t},e.normalFromMat4=function(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],h=e[6],u=e[7],c=e[8],l=e[9],d=e[10],f=e[11],p=e[12],m=e[13],v=e[14],M=e[15],y=n*a-i*o,g=n*h-r*o,b=n*u-s*o,w=i*h-r*a,x=i*u-s*a,_=r*u-s*h,A=c*m-l*p,S=c*v-d*p,P=c*M-f*p,R=l*v-d*m,L=l*M-f*m,D=d*M-f*v,E=y*D-g*L+b*R+w*P-x*S+_*A;if(!E)return null;return E=1/E,t[0]=(a*D-h*L+u*R)*E,t[1]=(h*P-o*D-u*S)*E,t[2]=(o*L-a*P+u*A)*E,t[3]=(r*L-i*D-s*R)*E,t[4]=(n*D-r*P+s*S)*E,t[5]=(i*P-n*L-s*A)*E,t[6]=(m*_-v*x+M*w)*E,t[7]=(v*b-p*_-M*g)*E,t[8]=(p*x-m*b+M*y)*E,t},e.projection=function(t,e,n){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/n,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t},e.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},e.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))},e.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t},e.subtract=s,e.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t},e.multiplyScalarAndAdd=function(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t[3]=e[3]+n[3]*i,t[4]=e[4]+n[4]*i,t[5]=e[5]+n[5]*i,t[6]=e[6]+n[6]*i,t[7]=e[7]+n[7]*i,t[8]=e[8]+n[8]*i,t},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]},e.equals=function(t,e){var n=t[0],r=t[1],s=t[2],o=t[3],a=t[4],h=t[5],u=t[6],c=t[7],l=t[8],d=e[0],f=e[1],p=e[2],m=e[3],v=e[4],M=e[5],y=e[6],g=e[7],b=e[8];return Math.abs(n-d)<=i.EPSILON*Math.max(1,Math.abs(n),Math.abs(d))&&Math.abs(r-f)<=i.EPSILON*Math.max(1,Math.abs(r),Math.abs(f))&&Math.abs(s-p)<=i.EPSILON*Math.max(1,Math.abs(s),Math.abs(p))&&Math.abs(o-m)<=i.EPSILON*Math.max(1,Math.abs(o),Math.abs(m))&&Math.abs(a-v)<=i.EPSILON*Math.max(1,Math.abs(a),Math.abs(v))&&Math.abs(h-M)<=i.EPSILON*Math.max(1,Math.abs(h),Math.abs(M))&&Math.abs(u-y)<=i.EPSILON*Math.max(1,Math.abs(u),Math.abs(y))&&Math.abs(c-g)<=i.EPSILON*Math.max(1,Math.abs(c),Math.abs(g))&&Math.abs(l-b)<=i.EPSILON*Math.max(1,Math.abs(l),Math.abs(b))};var i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(0));function r(t,e,n){var i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],h=e[5],u=e[6],c=e[7],l=e[8],d=n[0],f=n[1],p=n[2],m=n[3],v=n[4],M=n[5],y=n[6],g=n[7],b=n[8];return t[0]=d*i+f*o+p*u,t[1]=d*r+f*a+p*c,t[2]=d*s+f*h+p*l,t[3]=m*i+v*o+M*u,t[4]=m*r+v*a+M*c,t[5]=m*s+v*h+M*l,t[6]=y*i+g*o+b*u,t[7]=y*r+g*a+b*c,t[8]=y*s+g*h+b*l,t}function s(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t}e.mul=r,e.sub=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.forEach=e.sqrLen=e.len=e.sqrDist=e.dist=e.div=e.mul=e.sub=void 0,e.create=r,e.clone=function(t){var e=new i.ARRAY_TYPE(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},e.length=s,e.fromValues=o,e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},e.set=function(t,e,n,i){return t[0]=e,t[1]=n,t[2]=i,t},e.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t},e.subtract=a,e.multiply=h,e.divide=u,e.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t},e.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t},e.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t},e.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t},e.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t},e.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t},e.scaleAndAdd=function(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t},e.distance=c,e.squaredDistance=l,e.squaredLength=d,e.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},e.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t},e.normalize=f,e.dot=p,e.cross=function(t,e,n){var i=e[0],r=e[1],s=e[2],o=n[0],a=n[1],h=n[2];return t[0]=r*h-s*a,t[1]=s*o-i*h,t[2]=i*a-r*o,t},e.lerp=function(t,e,n,i){var r=e[0],s=e[1],o=e[2];return t[0]=r+i*(n[0]-r),t[1]=s+i*(n[1]-s),t[2]=o+i*(n[2]-o),t},e.hermite=function(t,e,n,i,r,s){var o=s*s,a=o*(2*s-3)+1,h=o*(s-2)+s,u=o*(s-1),c=o*(3-2*s);return t[0]=e[0]*a+n[0]*h+i[0]*u+r[0]*c,t[1]=e[1]*a+n[1]*h+i[1]*u+r[1]*c,t[2]=e[2]*a+n[2]*h+i[2]*u+r[2]*c,t},e.bezier=function(t,e,n,i,r,s){var o=1-s,a=o*o,h=s*s,u=a*o,c=3*s*a,l=3*h*o,d=h*s;return t[0]=e[0]*u+n[0]*c+i[0]*l+r[0]*d,t[1]=e[1]*u+n[1]*c+i[1]*l+r[1]*d,t[2]=e[2]*u+n[2]*c+i[2]*l+r[2]*d,t},e.random=function(t,e){e=e||1;var n=2*i.RANDOM()*Math.PI,r=2*i.RANDOM()-1,s=Math.sqrt(1-r*r)*e;return t[0]=Math.cos(n)*s,t[1]=Math.sin(n)*s,t[2]=r*e,t},e.transformMat4=function(t,e,n){var i=e[0],r=e[1],s=e[2],o=n[3]*i+n[7]*r+n[11]*s+n[15];return o=o||1,t[0]=(n[0]*i+n[4]*r+n[8]*s+n[12])/o,t[1]=(n[1]*i+n[5]*r+n[9]*s+n[13])/o,t[2]=(n[2]*i+n[6]*r+n[10]*s+n[14])/o,t},e.transformMat3=function(t,e,n){var i=e[0],r=e[1],s=e[2];return t[0]=i*n[0]+r*n[3]+s*n[6],t[1]=i*n[1]+r*n[4]+s*n[7],t[2]=i*n[2]+r*n[5]+s*n[8],t},e.transformQuat=function(t,e,n){var i=e[0],r=e[1],s=e[2],o=n[0],a=n[1],h=n[2],u=n[3],c=u*i+a*s-h*r,l=u*r+h*i-o*s,d=u*s+o*r-a*i,f=-o*i-a*r-h*s;return t[0]=c*u+f*-o+l*-h-d*-a,t[1]=l*u+f*-a+d*-o-c*-h,t[2]=d*u+f*-h+c*-a-l*-o,t},e.rotateX=function(t,e,n,i){var r=[],s=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],s[0]=r[0],s[1]=r[1]*Math.cos(i)-r[2]*Math.sin(i),s[2]=r[1]*Math.sin(i)+r[2]*Math.cos(i),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t},e.rotateY=function(t,e,n,i){var r=[],s=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],s[0]=r[2]*Math.sin(i)+r[0]*Math.cos(i),s[1]=r[1],s[2]=r[2]*Math.cos(i)-r[0]*Math.sin(i),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t},e.rotateZ=function(t,e,n,i){var r=[],s=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],s[0]=r[0]*Math.cos(i)-r[1]*Math.sin(i),s[1]=r[0]*Math.sin(i)+r[1]*Math.cos(i),s[2]=r[2],t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t},e.angle=function(t,e){var n=o(t[0],t[1],t[2]),i=o(e[0],e[1],e[2]);f(n,n),f(i,i);var r=p(n,i);return r>1?0:r<-1?Math.PI:Math.acos(r)},e.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},e.equals=function(t,e){var n=t[0],r=t[1],s=t[2],o=e[0],a=e[1],h=e[2];return Math.abs(n-o)<=i.EPSILON*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(r-a)<=i.EPSILON*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(s-h)<=i.EPSILON*Math.max(1,Math.abs(s),Math.abs(h))};var i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(0));function r(){var t=new i.ARRAY_TYPE(3);return t[0]=0,t[1]=0,t[2]=0,t}function s(t){var e=t[0],n=t[1],i=t[2];return Math.sqrt(e*e+n*n+i*i)}function o(t,e,n){var r=new i.ARRAY_TYPE(3);return r[0]=t,r[1]=e,r[2]=n,r}function a(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function h(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function u(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t}function c(t,e){var n=e[0]-t[0],i=e[1]-t[1],r=e[2]-t[2];return Math.sqrt(n*n+i*i+r*r)}function l(t,e){var n=e[0]-t[0],i=e[1]-t[1],r=e[2]-t[2];return n*n+i*i+r*r}function d(t){var e=t[0],n=t[1],i=t[2];return e*e+n*n+i*i}function f(t,e){var n=e[0],i=e[1],r=e[2],s=n*n+i*i+r*r;return s>0&&(s=1/Math.sqrt(s),t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s),t}function p(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}var m;e.sub=a,e.mul=h,e.div=u,e.dist=c,e.sqrDist=l,e.len=s,e.sqrLen=d,e.forEach=(m=r(),function(t,e,n,i,r,s){var o=void 0,a=void 0;for(e||(e=3),n||(n=0),a=i?Math.min(i*e+n,t.length):t.length,o=n;o<a;o+=e)m[0]=t[o],m[1]=t[o+1],m[2]=t[o+2],r(m,m,s),t[o]=m[0],t[o+1]=m[1],t[o+2]=m[2];return t})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.forEach=e.sqrLen=e.len=e.sqrDist=e.dist=e.div=e.mul=e.sub=void 0,e.create=r,e.clone=function(t){var e=new i.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},e.fromValues=function(t,e,n,r){var s=new i.ARRAY_TYPE(4);return s[0]=t,s[1]=e,s[2]=n,s[3]=r,s},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},e.set=function(t,e,n,i,r){return t[0]=e,t[1]=n,t[2]=i,t[3]=r,t},e.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t},e.subtract=s,e.multiply=o,e.divide=a,e.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t},e.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t},e.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t[3]=Math.min(e[3],n[3]),t},e.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t[3]=Math.max(e[3],n[3]),t},e.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t},e.scale=h,e.scaleAndAdd=function(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t[3]=e[3]+n[3]*i,t},e.distance=u,e.squaredDistance=c,e.length=l,e.squaredLength=d,e.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},e.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t},e.normalize=f,e.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},e.lerp=function(t,e,n,i){var r=e[0],s=e[1],o=e[2],a=e[3];return t[0]=r+i*(n[0]-r),t[1]=s+i*(n[1]-s),t[2]=o+i*(n[2]-o),t[3]=a+i*(n[3]-a),t},e.random=function(t,e){return e=e||1,t[0]=i.RANDOM(),t[1]=i.RANDOM(),t[2]=i.RANDOM(),t[3]=i.RANDOM(),f(t,t),h(t,t,e),t},e.transformMat4=function(t,e,n){var i=e[0],r=e[1],s=e[2],o=e[3];return t[0]=n[0]*i+n[4]*r+n[8]*s+n[12]*o,t[1]=n[1]*i+n[5]*r+n[9]*s+n[13]*o,t[2]=n[2]*i+n[6]*r+n[10]*s+n[14]*o,t[3]=n[3]*i+n[7]*r+n[11]*s+n[15]*o,t},e.transformQuat=function(t,e,n){var i=e[0],r=e[1],s=e[2],o=n[0],a=n[1],h=n[2],u=n[3],c=u*i+a*s-h*r,l=u*r+h*i-o*s,d=u*s+o*r-a*i,f=-o*i-a*r-h*s;return t[0]=c*u+f*-o+l*-h-d*-a,t[1]=l*u+f*-a+d*-o-c*-h,t[2]=d*u+f*-h+c*-a-l*-o,t[3]=e[3],t},e.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},e.equals=function(t,e){var n=t[0],r=t[1],s=t[2],o=t[3],a=e[0],h=e[1],u=e[2],c=e[3];return Math.abs(n-a)<=i.EPSILON*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(r-h)<=i.EPSILON*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(s-u)<=i.EPSILON*Math.max(1,Math.abs(s),Math.abs(u))&&Math.abs(o-c)<=i.EPSILON*Math.max(1,Math.abs(o),Math.abs(c))};var i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(0));function r(){var t=new i.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}function s(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}function o(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t}function a(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t[3]=e[3]/n[3],t}function h(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function u(t,e){var n=e[0]-t[0],i=e[1]-t[1],r=e[2]-t[2],s=e[3]-t[3];return Math.sqrt(n*n+i*i+r*r+s*s)}function c(t,e){var n=e[0]-t[0],i=e[1]-t[1],r=e[2]-t[2],s=e[3]-t[3];return n*n+i*i+r*r+s*s}function l(t){var e=t[0],n=t[1],i=t[2],r=t[3];return Math.sqrt(e*e+n*n+i*i+r*r)}function d(t){var e=t[0],n=t[1],i=t[2],r=t[3];return e*e+n*n+i*i+r*r}function f(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],o=n*n+i*i+r*r+s*s;return o>0&&(o=1/Math.sqrt(o),t[0]=n*o,t[1]=i*o,t[2]=r*o,t[3]=s*o),t}var p;e.sub=s,e.mul=o,e.div=a,e.dist=u,e.sqrDist=c,e.len=l,e.sqrLen=d,e.forEach=(p=r(),function(t,e,n,i,r,s){var o=void 0,a=void 0;for(e||(e=4),n||(n=0),a=i?Math.min(i*e+n,t.length):t.length,o=n;o<a;o+=e)p[0]=t[o],p[1]=t[o+1],p[2]=t[o+2],p[3]=t[o+3],r(p,p,s),t[o]=p[0],t[o+1]=p[1],t[o+2]=p[2],t[o+3]=p[3];return t})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.vec4=e.vec3=e.vec2=e.quat=e.mat4=e.mat3=e.mat2d=e.mat2=e.glMatrix=void 0;var i=d(n(0)),r=d(n(5)),s=d(n(6)),o=d(n(1)),a=d(n(7)),h=d(n(8)),u=d(n(9)),c=d(n(2)),l=d(n(3));function d(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}e.glMatrix=i,e.mat2=r,e.mat2d=s,e.mat3=o,e.mat4=a,e.quat=h,e.vec2=u,e.vec3=c,e.vec4=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.sub=e.mul=void 0,e.create=function(){var t=new i.ARRAY_TYPE(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},e.clone=function(t){var e=new i.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},e.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},e.fromValues=function(t,e,n,r){var s=new i.ARRAY_TYPE(4);return s[0]=t,s[1]=e,s[2]=n,s[3]=r,s},e.set=function(t,e,n,i,r){return t[0]=e,t[1]=n,t[2]=i,t[3]=r,t},e.transpose=function(t,e){if(t===e){var n=e[1];t[1]=e[2],t[2]=n}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t},e.invert=function(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],o=n*s-r*i;if(!o)return null;return o=1/o,t[0]=s*o,t[1]=-i*o,t[2]=-r*o,t[3]=n*o,t},e.adjoint=function(t,e){var n=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=n,t},e.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},e.multiply=r,e.rotate=function(t,e,n){var i=e[0],r=e[1],s=e[2],o=e[3],a=Math.sin(n),h=Math.cos(n);return t[0]=i*h+s*a,t[1]=r*h+o*a,t[2]=i*-a+s*h,t[3]=r*-a+o*h,t},e.scale=function(t,e,n){var i=e[0],r=e[1],s=e[2],o=e[3],a=n[0],h=n[1];return t[0]=i*a,t[1]=r*a,t[2]=s*h,t[3]=o*h,t},e.fromRotation=function(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=n,t[2]=-n,t[3]=i,t},e.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t},e.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},e.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))},e.LDU=function(t,e,n,i){return t[2]=i[2]/i[0],n[0]=i[0],n[1]=i[1],n[3]=i[3]-t[2]*n[1],[t,e,n]},e.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t},e.subtract=s,e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},e.equals=function(t,e){var n=t[0],r=t[1],s=t[2],o=t[3],a=e[0],h=e[1],u=e[2],c=e[3];return Math.abs(n-a)<=i.EPSILON*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(r-h)<=i.EPSILON*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(s-u)<=i.EPSILON*Math.max(1,Math.abs(s),Math.abs(u))&&Math.abs(o-c)<=i.EPSILON*Math.max(1,Math.abs(o),Math.abs(c))},e.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},e.multiplyScalarAndAdd=function(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t[3]=e[3]+n[3]*i,t};var i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(0));function r(t,e,n){var i=e[0],r=e[1],s=e[2],o=e[3],a=n[0],h=n[1],u=n[2],c=n[3];return t[0]=i*a+s*h,t[1]=r*a+o*h,t[2]=i*u+s*c,t[3]=r*u+o*c,t}function s(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}e.mul=r,e.sub=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.sub=e.mul=void 0,e.create=function(){var t=new i.ARRAY_TYPE(6);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},e.clone=function(t){var e=new i.ARRAY_TYPE(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},e.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},e.fromValues=function(t,e,n,r,s,o){var a=new i.ARRAY_TYPE(6);return a[0]=t,a[1]=e,a[2]=n,a[3]=r,a[4]=s,a[5]=o,a},e.set=function(t,e,n,i,r,s,o){return t[0]=e,t[1]=n,t[2]=i,t[3]=r,t[4]=s,t[5]=o,t},e.invert=function(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],h=n*s-i*r;if(!h)return null;return h=1/h,t[0]=s*h,t[1]=-i*h,t[2]=-r*h,t[3]=n*h,t[4]=(r*a-s*o)*h,t[5]=(i*o-n*a)*h,t},e.determinant=function(t){return t[0]*t[3]-t[1]*t[2]},e.multiply=r,e.rotate=function(t,e,n){var i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],h=e[5],u=Math.sin(n),c=Math.cos(n);return t[0]=i*c+s*u,t[1]=r*c+o*u,t[2]=i*-u+s*c,t[3]=r*-u+o*c,t[4]=a,t[5]=h,t},e.scale=function(t,e,n){var i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],h=e[5],u=n[0],c=n[1];return t[0]=i*u,t[1]=r*u,t[2]=s*c,t[3]=o*c,t[4]=a,t[5]=h,t},e.translate=function(t,e,n){var i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],h=e[5],u=n[0],c=n[1];return t[0]=i,t[1]=r,t[2]=s,t[3]=o,t[4]=i*u+s*c+a,t[5]=r*u+o*c+h,t},e.fromRotation=function(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=n,t[2]=-n,t[3]=i,t[4]=0,t[5]=0,t},e.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t},e.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t},e.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},e.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+1)},e.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t},e.subtract=s,e.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t},e.multiplyScalarAndAdd=function(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t[3]=e[3]+n[3]*i,t[4]=e[4]+n[4]*i,t[5]=e[5]+n[5]*i,t},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]},e.equals=function(t,e){var n=t[0],r=t[1],s=t[2],o=t[3],a=t[4],h=t[5],u=e[0],c=e[1],l=e[2],d=e[3],f=e[4],p=e[5];return Math.abs(n-u)<=i.EPSILON*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(r-c)<=i.EPSILON*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(s-l)<=i.EPSILON*Math.max(1,Math.abs(s),Math.abs(l))&&Math.abs(o-d)<=i.EPSILON*Math.max(1,Math.abs(o),Math.abs(d))&&Math.abs(a-f)<=i.EPSILON*Math.max(1,Math.abs(a),Math.abs(f))&&Math.abs(h-p)<=i.EPSILON*Math.max(1,Math.abs(h),Math.abs(p))};var i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(0));function r(t,e,n){var i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],h=e[5],u=n[0],c=n[1],l=n[2],d=n[3],f=n[4],p=n[5];return t[0]=i*u+s*c,t[1]=r*u+o*c,t[2]=i*l+s*d,t[3]=r*l+o*d,t[4]=i*f+s*p+a,t[5]=r*f+o*p+h,t}function s(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t}e.mul=r,e.sub=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.sub=e.mul=void 0,e.create=function(){var t=new i.ARRAY_TYPE(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.clone=function(t){var e=new i.ARRAY_TYPE(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},e.fromValues=function(t,e,n,r,s,o,a,h,u,c,l,d,f,p,m,v){var M=new i.ARRAY_TYPE(16);return M[0]=t,M[1]=e,M[2]=n,M[3]=r,M[4]=s,M[5]=o,M[6]=a,M[7]=h,M[8]=u,M[9]=c,M[10]=l,M[11]=d,M[12]=f,M[13]=p,M[14]=m,M[15]=v,M},e.set=function(t,e,n,i,r,s,o,a,h,u,c,l,d,f,p,m,v){return t[0]=e,t[1]=n,t[2]=i,t[3]=r,t[4]=s,t[5]=o,t[6]=a,t[7]=h,t[8]=u,t[9]=c,t[10]=l,t[11]=d,t[12]=f,t[13]=p,t[14]=m,t[15]=v,t},e.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.transpose=function(t,e){if(t===e){var n=e[1],i=e[2],r=e[3],s=e[6],o=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=i,t[9]=s,t[11]=e[14],t[12]=r,t[13]=o,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t},e.invert=function(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],h=e[6],u=e[7],c=e[8],l=e[9],d=e[10],f=e[11],p=e[12],m=e[13],v=e[14],M=e[15],y=n*a-i*o,g=n*h-r*o,b=n*u-s*o,w=i*h-r*a,x=i*u-s*a,_=r*u-s*h,A=c*m-l*p,S=c*v-d*p,P=c*M-f*p,R=l*v-d*m,L=l*M-f*m,D=d*M-f*v,E=y*D-g*L+b*R+w*P-x*S+_*A;if(!E)return null;return E=1/E,t[0]=(a*D-h*L+u*R)*E,t[1]=(r*L-i*D-s*R)*E,t[2]=(m*_-v*x+M*w)*E,t[3]=(d*x-l*_-f*w)*E,t[4]=(h*P-o*D-u*S)*E,t[5]=(n*D-r*P+s*S)*E,t[6]=(v*b-p*_-M*g)*E,t[7]=(c*_-d*b+f*g)*E,t[8]=(o*L-a*P+u*A)*E,t[9]=(i*P-n*L-s*A)*E,t[10]=(p*x-m*b+M*y)*E,t[11]=(l*b-c*x-f*y)*E,t[12]=(a*S-o*R-h*A)*E,t[13]=(n*R-i*S+r*A)*E,t[14]=(m*g-p*w-v*y)*E,t[15]=(c*w-l*g+d*y)*E,t},e.adjoint=function(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],h=e[6],u=e[7],c=e[8],l=e[9],d=e[10],f=e[11],p=e[12],m=e[13],v=e[14],M=e[15];return t[0]=a*(d*M-f*v)-l*(h*M-u*v)+m*(h*f-u*d),t[1]=-(i*(d*M-f*v)-l*(r*M-s*v)+m*(r*f-s*d)),t[2]=i*(h*M-u*v)-a*(r*M-s*v)+m*(r*u-s*h),t[3]=-(i*(h*f-u*d)-a*(r*f-s*d)+l*(r*u-s*h)),t[4]=-(o*(d*M-f*v)-c*(h*M-u*v)+p*(h*f-u*d)),t[5]=n*(d*M-f*v)-c*(r*M-s*v)+p*(r*f-s*d),t[6]=-(n*(h*M-u*v)-o*(r*M-s*v)+p*(r*u-s*h)),t[7]=n*(h*f-u*d)-o*(r*f-s*d)+c*(r*u-s*h),t[8]=o*(l*M-f*m)-c*(a*M-u*m)+p*(a*f-u*l),t[9]=-(n*(l*M-f*m)-c*(i*M-s*m)+p*(i*f-s*l)),t[10]=n*(a*M-u*m)-o*(i*M-s*m)+p*(i*u-s*a),t[11]=-(n*(a*f-u*l)-o*(i*f-s*l)+c*(i*u-s*a)),t[12]=-(o*(l*v-d*m)-c*(a*v-h*m)+p*(a*d-h*l)),t[13]=n*(l*v-d*m)-c*(i*v-r*m)+p*(i*d-r*l),t[14]=-(n*(a*v-h*m)-o*(i*v-r*m)+p*(i*h-r*a)),t[15]=n*(a*d-h*l)-o*(i*d-r*l)+c*(i*h-r*a),t},e.determinant=function(t){var e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],o=t[5],a=t[6],h=t[7],u=t[8],c=t[9],l=t[10],d=t[11],f=t[12],p=t[13],m=t[14],v=t[15];return(e*o-n*s)*(l*v-d*m)-(e*a-i*s)*(c*v-d*p)+(e*h-r*s)*(c*m-l*p)+(n*a-i*o)*(u*v-d*f)-(n*h-r*o)*(u*m-l*f)+(i*h-r*a)*(u*p-c*f)},e.multiply=r,e.translate=function(t,e,n){var i=n[0],r=n[1],s=n[2],o=void 0,a=void 0,h=void 0,u=void 0,c=void 0,l=void 0,d=void 0,f=void 0,p=void 0,m=void 0,v=void 0,M=void 0;e===t?(t[12]=e[0]*i+e[4]*r+e[8]*s+e[12],t[13]=e[1]*i+e[5]*r+e[9]*s+e[13],t[14]=e[2]*i+e[6]*r+e[10]*s+e[14],t[15]=e[3]*i+e[7]*r+e[11]*s+e[15]):(o=e[0],a=e[1],h=e[2],u=e[3],c=e[4],l=e[5],d=e[6],f=e[7],p=e[8],m=e[9],v=e[10],M=e[11],t[0]=o,t[1]=a,t[2]=h,t[3]=u,t[4]=c,t[5]=l,t[6]=d,t[7]=f,t[8]=p,t[9]=m,t[10]=v,t[11]=M,t[12]=o*i+c*r+p*s+e[12],t[13]=a*i+l*r+m*s+e[13],t[14]=h*i+d*r+v*s+e[14],t[15]=u*i+f*r+M*s+e[15]);return t},e.scale=function(t,e,n){var i=n[0],r=n[1],s=n[2];return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*s,t[9]=e[9]*s,t[10]=e[10]*s,t[11]=e[11]*s,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},e.rotate=function(t,e,n,r){var s=r[0],o=r[1],a=r[2],h=Math.sqrt(s*s+o*o+a*a),u=void 0,c=void 0,l=void 0,d=void 0,f=void 0,p=void 0,m=void 0,v=void 0,M=void 0,y=void 0,g=void 0,b=void 0,w=void 0,x=void 0,_=void 0,A=void 0,S=void 0,P=void 0,R=void 0,L=void 0,D=void 0,E=void 0,I=void 0,N=void 0;if(Math.abs(h)<i.EPSILON)return null;s*=h=1/h,o*=h,a*=h,u=Math.sin(n),c=Math.cos(n),l=1-c,d=e[0],f=e[1],p=e[2],m=e[3],v=e[4],M=e[5],y=e[6],g=e[7],b=e[8],w=e[9],x=e[10],_=e[11],A=s*s*l+c,S=o*s*l+a*u,P=a*s*l-o*u,R=s*o*l-a*u,L=o*o*l+c,D=a*o*l+s*u,E=s*a*l+o*u,I=o*a*l-s*u,N=a*a*l+c,t[0]=d*A+v*S+b*P,t[1]=f*A+M*S+w*P,t[2]=p*A+y*S+x*P,t[3]=m*A+g*S+_*P,t[4]=d*R+v*L+b*D,t[5]=f*R+M*L+w*D,t[6]=p*R+y*L+x*D,t[7]=m*R+g*L+_*D,t[8]=d*E+v*I+b*N,t[9]=f*E+M*I+w*N,t[10]=p*E+y*I+x*N,t[11]=m*E+g*I+_*N,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);return t},e.rotateX=function(t,e,n){var i=Math.sin(n),r=Math.cos(n),s=e[4],o=e[5],a=e[6],h=e[7],u=e[8],c=e[9],l=e[10],d=e[11];e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);return t[4]=s*r+u*i,t[5]=o*r+c*i,t[6]=a*r+l*i,t[7]=h*r+d*i,t[8]=u*r-s*i,t[9]=c*r-o*i,t[10]=l*r-a*i,t[11]=d*r-h*i,t},e.rotateY=function(t,e,n){var i=Math.sin(n),r=Math.cos(n),s=e[0],o=e[1],a=e[2],h=e[3],u=e[8],c=e[9],l=e[10],d=e[11];e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);return t[0]=s*r-u*i,t[1]=o*r-c*i,t[2]=a*r-l*i,t[3]=h*r-d*i,t[8]=s*i+u*r,t[9]=o*i+c*r,t[10]=a*i+l*r,t[11]=h*i+d*r,t},e.rotateZ=function(t,e,n){var i=Math.sin(n),r=Math.cos(n),s=e[0],o=e[1],a=e[2],h=e[3],u=e[4],c=e[5],l=e[6],d=e[7];e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);return t[0]=s*r+u*i,t[1]=o*r+c*i,t[2]=a*r+l*i,t[3]=h*r+d*i,t[4]=u*r-s*i,t[5]=c*r-o*i,t[6]=l*r-a*i,t[7]=d*r-h*i,t},e.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},e.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromRotation=function(t,e,n){var r=n[0],s=n[1],o=n[2],a=Math.sqrt(r*r+s*s+o*o),h=void 0,u=void 0,c=void 0;if(Math.abs(a)<i.EPSILON)return null;return r*=a=1/a,s*=a,o*=a,h=Math.sin(e),u=Math.cos(e),c=1-u,t[0]=r*r*c+u,t[1]=s*r*c+o*h,t[2]=o*r*c-s*h,t[3]=0,t[4]=r*s*c-o*h,t[5]=s*s*c+u,t[6]=o*s*c+r*h,t[7]=0,t[8]=r*o*c+s*h,t[9]=s*o*c-r*h,t[10]=o*o*c+u,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromXRotation=function(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromYRotation=function(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromZRotation=function(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromRotationTranslation=function(t,e,n){var i=e[0],r=e[1],s=e[2],o=e[3],a=i+i,h=r+r,u=s+s,c=i*a,l=i*h,d=i*u,f=r*h,p=r*u,m=s*u,v=o*a,M=o*h,y=o*u;return t[0]=1-(f+m),t[1]=l+y,t[2]=d-M,t[3]=0,t[4]=l-y,t[5]=1-(c+m),t[6]=p+v,t[7]=0,t[8]=d+M,t[9]=p-v,t[10]=1-(c+f),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t},e.getTranslation=function(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t},e.getScaling=function(t,e){var n=e[0],i=e[1],r=e[2],s=e[4],o=e[5],a=e[6],h=e[8],u=e[9],c=e[10];return t[0]=Math.sqrt(n*n+i*i+r*r),t[1]=Math.sqrt(s*s+o*o+a*a),t[2]=Math.sqrt(h*h+u*u+c*c),t},e.getRotation=function(t,e){var n=e[0]+e[5]+e[10],i=0;n>0?(i=2*Math.sqrt(n+1),t[3]=.25*i,t[0]=(e[6]-e[9])/i,t[1]=(e[8]-e[2])/i,t[2]=(e[1]-e[4])/i):e[0]>e[5]&e[0]>e[10]?(i=2*Math.sqrt(1+e[0]-e[5]-e[10]),t[3]=(e[6]-e[9])/i,t[0]=.25*i,t[1]=(e[1]+e[4])/i,t[2]=(e[8]+e[2])/i):e[5]>e[10]?(i=2*Math.sqrt(1+e[5]-e[0]-e[10]),t[3]=(e[8]-e[2])/i,t[0]=(e[1]+e[4])/i,t[1]=.25*i,t[2]=(e[6]+e[9])/i):(i=2*Math.sqrt(1+e[10]-e[0]-e[5]),t[3]=(e[1]-e[4])/i,t[0]=(e[8]+e[2])/i,t[1]=(e[6]+e[9])/i,t[2]=.25*i);return t},e.fromRotationTranslationScale=function(t,e,n,i){var r=e[0],s=e[1],o=e[2],a=e[3],h=r+r,u=s+s,c=o+o,l=r*h,d=r*u,f=r*c,p=s*u,m=s*c,v=o*c,M=a*h,y=a*u,g=a*c,b=i[0],w=i[1],x=i[2];return t[0]=(1-(p+v))*b,t[1]=(d+g)*b,t[2]=(f-y)*b,t[3]=0,t[4]=(d-g)*w,t[5]=(1-(l+v))*w,t[6]=(m+M)*w,t[7]=0,t[8]=(f+y)*x,t[9]=(m-M)*x,t[10]=(1-(l+p))*x,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t},e.fromRotationTranslationScaleOrigin=function(t,e,n,i,r){var s=e[0],o=e[1],a=e[2],h=e[3],u=s+s,c=o+o,l=a+a,d=s*u,f=s*c,p=s*l,m=o*c,v=o*l,M=a*l,y=h*u,g=h*c,b=h*l,w=i[0],x=i[1],_=i[2],A=r[0],S=r[1],P=r[2];return t[0]=(1-(m+M))*w,t[1]=(f+b)*w,t[2]=(p-g)*w,t[3]=0,t[4]=(f-b)*x,t[5]=(1-(d+M))*x,t[6]=(v+y)*x,t[7]=0,t[8]=(p+g)*_,t[9]=(v-y)*_,t[10]=(1-(d+m))*_,t[11]=0,t[12]=n[0]+A-(t[0]*A+t[4]*S+t[8]*P),t[13]=n[1]+S-(t[1]*A+t[5]*S+t[9]*P),t[14]=n[2]+P-(t[2]*A+t[6]*S+t[10]*P),t[15]=1,t},e.fromQuat=function(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],o=n+n,a=i+i,h=r+r,u=n*o,c=i*o,l=i*a,d=r*o,f=r*a,p=r*h,m=s*o,v=s*a,M=s*h;return t[0]=1-l-p,t[1]=c+M,t[2]=d-v,t[3]=0,t[4]=c-M,t[5]=1-u-p,t[6]=f+m,t[7]=0,t[8]=d+v,t[9]=f-m,t[10]=1-u-l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.frustum=function(t,e,n,i,r,s,o){var a=1/(n-e),h=1/(r-i),u=1/(s-o);return t[0]=2*s*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*s*h,t[6]=0,t[7]=0,t[8]=(n+e)*a,t[9]=(r+i)*h,t[10]=(o+s)*u,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*s*2*u,t[15]=0,t},e.perspective=function(t,e,n,i,r){var s=1/Math.tan(e/2),o=1/(i-r);return t[0]=s/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(r+i)*o,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*r*i*o,t[15]=0,t},e.perspectiveFromFieldOfView=function(t,e,n,i){var r=Math.tan(e.upDegrees*Math.PI/180),s=Math.tan(e.downDegrees*Math.PI/180),o=Math.tan(e.leftDegrees*Math.PI/180),a=Math.tan(e.rightDegrees*Math.PI/180),h=2/(o+a),u=2/(r+s);return t[0]=h,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=u,t[6]=0,t[7]=0,t[8]=-(o-a)*h*.5,t[9]=(r-s)*u*.5,t[10]=i/(n-i),t[11]=-1,t[12]=0,t[13]=0,t[14]=i*n/(n-i),t[15]=0,t},e.ortho=function(t,e,n,i,r,s,o){var a=1/(e-n),h=1/(i-r),u=1/(s-o);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*h,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+n)*a,t[13]=(r+i)*h,t[14]=(o+s)*u,t[15]=1,t},e.lookAt=function(t,e,n,r){var s=void 0,o=void 0,a=void 0,h=void 0,u=void 0,c=void 0,l=void 0,d=void 0,f=void 0,p=void 0,m=e[0],v=e[1],M=e[2],y=r[0],g=r[1],b=r[2],w=n[0],x=n[1],_=n[2];if(Math.abs(m-w)<i.EPSILON&&Math.abs(v-x)<i.EPSILON&&Math.abs(M-_)<i.EPSILON)return mat4.identity(t);l=m-w,d=v-x,f=M-_,p=1/Math.sqrt(l*l+d*d+f*f),s=g*(f*=p)-b*(d*=p),o=b*(l*=p)-y*f,a=y*d-g*l,(p=Math.sqrt(s*s+o*o+a*a))?(s*=p=1/p,o*=p,a*=p):(s=0,o=0,a=0);h=d*a-f*o,u=f*s-l*a,c=l*o-d*s,(p=Math.sqrt(h*h+u*u+c*c))?(h*=p=1/p,u*=p,c*=p):(h=0,u=0,c=0);return t[0]=s,t[1]=h,t[2]=l,t[3]=0,t[4]=o,t[5]=u,t[6]=d,t[7]=0,t[8]=a,t[9]=c,t[10]=f,t[11]=0,t[12]=-(s*m+o*v+a*M),t[13]=-(h*m+u*v+c*M),t[14]=-(l*m+d*v+f*M),t[15]=1,t},e.targetTo=function(t,e,n,i){var r=e[0],s=e[1],o=e[2],a=i[0],h=i[1],u=i[2],c=r-n[0],l=s-n[1],d=o-n[2],f=c*c+l*l+d*d;f>0&&(f=1/Math.sqrt(f),c*=f,l*=f,d*=f);var p=h*d-u*l,m=u*c-a*d,v=a*l-h*c;return t[0]=p,t[1]=m,t[2]=v,t[3]=0,t[4]=l*v-d*m,t[5]=d*p-c*v,t[6]=c*m-l*p,t[7]=0,t[8]=c,t[9]=l,t[10]=d,t[11]=0,t[12]=r,t[13]=s,t[14]=o,t[15]=1,t},e.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},e.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))},e.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t},e.subtract=s,e.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t},e.multiplyScalarAndAdd=function(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t[3]=e[3]+n[3]*i,t[4]=e[4]+n[4]*i,t[5]=e[5]+n[5]*i,t[6]=e[6]+n[6]*i,t[7]=e[7]+n[7]*i,t[8]=e[8]+n[8]*i,t[9]=e[9]+n[9]*i,t[10]=e[10]+n[10]*i,t[11]=e[11]+n[11]*i,t[12]=e[12]+n[12]*i,t[13]=e[13]+n[13]*i,t[14]=e[14]+n[14]*i,t[15]=e[15]+n[15]*i,t},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]},e.equals=function(t,e){var n=t[0],r=t[1],s=t[2],o=t[3],a=t[4],h=t[5],u=t[6],c=t[7],l=t[8],d=t[9],f=t[10],p=t[11],m=t[12],v=t[13],M=t[14],y=t[15],g=e[0],b=e[1],w=e[2],x=e[3],_=e[4],A=e[5],S=e[6],P=e[7],R=e[8],L=e[9],D=e[10],E=e[11],I=e[12],N=e[13],Y=e[14],O=e[15];return Math.abs(n-g)<=i.EPSILON*Math.max(1,Math.abs(n),Math.abs(g))&&Math.abs(r-b)<=i.EPSILON*Math.max(1,Math.abs(r),Math.abs(b))&&Math.abs(s-w)<=i.EPSILON*Math.max(1,Math.abs(s),Math.abs(w))&&Math.abs(o-x)<=i.EPSILON*Math.max(1,Math.abs(o),Math.abs(x))&&Math.abs(a-_)<=i.EPSILON*Math.max(1,Math.abs(a),Math.abs(_))&&Math.abs(h-A)<=i.EPSILON*Math.max(1,Math.abs(h),Math.abs(A))&&Math.abs(u-S)<=i.EPSILON*Math.max(1,Math.abs(u),Math.abs(S))&&Math.abs(c-P)<=i.EPSILON*Math.max(1,Math.abs(c),Math.abs(P))&&Math.abs(l-R)<=i.EPSILON*Math.max(1,Math.abs(l),Math.abs(R))&&Math.abs(d-L)<=i.EPSILON*Math.max(1,Math.abs(d),Math.abs(L))&&Math.abs(f-D)<=i.EPSILON*Math.max(1,Math.abs(f),Math.abs(D))&&Math.abs(p-E)<=i.EPSILON*Math.max(1,Math.abs(p),Math.abs(E))&&Math.abs(m-I)<=i.EPSILON*Math.max(1,Math.abs(m),Math.abs(I))&&Math.abs(v-N)<=i.EPSILON*Math.max(1,Math.abs(v),Math.abs(N))&&Math.abs(M-Y)<=i.EPSILON*Math.max(1,Math.abs(M),Math.abs(Y))&&Math.abs(y-O)<=i.EPSILON*Math.max(1,Math.abs(y),Math.abs(O))};var i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(0));function r(t,e,n){var i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],h=e[5],u=e[6],c=e[7],l=e[8],d=e[9],f=e[10],p=e[11],m=e[12],v=e[13],M=e[14],y=e[15],g=n[0],b=n[1],w=n[2],x=n[3];return t[0]=g*i+b*a+w*l+x*m,t[1]=g*r+b*h+w*d+x*v,t[2]=g*s+b*u+w*f+x*M,t[3]=g*o+b*c+w*p+x*y,g=n[4],b=n[5],w=n[6],x=n[7],t[4]=g*i+b*a+w*l+x*m,t[5]=g*r+b*h+w*d+x*v,t[6]=g*s+b*u+w*f+x*M,t[7]=g*o+b*c+w*p+x*y,g=n[8],b=n[9],w=n[10],x=n[11],t[8]=g*i+b*a+w*l+x*m,t[9]=g*r+b*h+w*d+x*v,t[10]=g*s+b*u+w*f+x*M,t[11]=g*o+b*c+w*p+x*y,g=n[12],b=n[13],w=n[14],x=n[15],t[12]=g*i+b*a+w*l+x*m,t[13]=g*r+b*h+w*d+x*v,t[14]=g*s+b*u+w*f+x*M,t[15]=g*o+b*c+w*p+x*y,t}function s(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t}e.mul=r,e.sub=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.setAxes=e.sqlerp=e.rotationTo=e.equals=e.exactEquals=e.normalize=e.sqrLen=e.squaredLength=e.len=e.length=e.lerp=e.dot=e.scale=e.mul=e.add=e.set=e.copy=e.fromValues=e.clone=void 0,e.create=h,e.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},e.setAxisAngle=u,e.getAxisAngle=function(t,e){var n=2*Math.acos(e[3]),i=Math.sin(n/2);0!=i?(t[0]=e[0]/i,t[1]=e[1]/i,t[2]=e[2]/i):(t[0]=1,t[1]=0,t[2]=0);return n},e.multiply=c,e.rotateX=function(t,e,n){n*=.5;var i=e[0],r=e[1],s=e[2],o=e[3],a=Math.sin(n),h=Math.cos(n);return t[0]=i*h+o*a,t[1]=r*h+s*a,t[2]=s*h-r*a,t[3]=o*h-i*a,t},e.rotateY=function(t,e,n){n*=.5;var i=e[0],r=e[1],s=e[2],o=e[3],a=Math.sin(n),h=Math.cos(n);return t[0]=i*h-s*a,t[1]=r*h+o*a,t[2]=s*h+i*a,t[3]=o*h-r*a,t},e.rotateZ=function(t,e,n){n*=.5;var i=e[0],r=e[1],s=e[2],o=e[3],a=Math.sin(n),h=Math.cos(n);return t[0]=i*h+r*a,t[1]=r*h-i*a,t[2]=s*h+o*a,t[3]=o*h-s*a,t},e.calculateW=function(t,e){var n=e[0],i=e[1],r=e[2];return t[0]=n,t[1]=i,t[2]=r,t[3]=Math.sqrt(Math.abs(1-n*n-i*i-r*r)),t},e.slerp=l,e.invert=function(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],o=n*n+i*i+r*r+s*s,a=o?1/o:0;return t[0]=-n*a,t[1]=-i*a,t[2]=-r*a,t[3]=s*a,t},e.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},e.fromMat3=d,e.fromEuler=function(t,e,n,i){var r=.5*Math.PI/180;e*=r,n*=r,i*=r;var s=Math.sin(e),o=Math.cos(e),a=Math.sin(n),h=Math.cos(n),u=Math.sin(i),c=Math.cos(i);return t[0]=s*h*c-o*a*u,t[1]=o*a*c+s*h*u,t[2]=o*h*u-s*a*c,t[3]=o*h*c+s*a*u,t},e.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"};var i=a(n(0)),r=a(n(1)),s=a(n(2)),o=a(n(3));function a(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function h(){var t=new i.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function u(t,e,n){n*=.5;var i=Math.sin(n);return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=Math.cos(n),t}function c(t,e,n){var i=e[0],r=e[1],s=e[2],o=e[3],a=n[0],h=n[1],u=n[2],c=n[3];return t[0]=i*c+o*a+r*u-s*h,t[1]=r*c+o*h+s*a-i*u,t[2]=s*c+o*u+i*h-r*a,t[3]=o*c-i*a-r*h-s*u,t}function l(t,e,n,i){var r=e[0],s=e[1],o=e[2],a=e[3],h=n[0],u=n[1],c=n[2],l=n[3],d=void 0,f=void 0,p=void 0,m=void 0,v=void 0;return(f=r*h+s*u+o*c+a*l)<0&&(f=-f,h=-h,u=-u,c=-c,l=-l),1-f>1e-6?(d=Math.acos(f),p=Math.sin(d),m=Math.sin((1-i)*d)/p,v=Math.sin(i*d)/p):(m=1-i,v=i),t[0]=m*r+v*h,t[1]=m*s+v*u,t[2]=m*o+v*c,t[3]=m*a+v*l,t}function d(t,e){var n=e[0]+e[4]+e[8],i=void 0;if(n>0)i=Math.sqrt(n+1),t[3]=.5*i,i=.5/i,t[0]=(e[5]-e[7])*i,t[1]=(e[6]-e[2])*i,t[2]=(e[1]-e[3])*i;else{var r=0;e[4]>e[0]&&(r=1),e[8]>e[3*r+r]&&(r=2);var s=(r+1)%3,o=(r+2)%3;i=Math.sqrt(e[3*r+r]-e[3*s+s]-e[3*o+o]+1),t[r]=.5*i,i=.5/i,t[3]=(e[3*s+o]-e[3*o+s])*i,t[s]=(e[3*s+r]+e[3*r+s])*i,t[o]=(e[3*o+r]+e[3*r+o])*i}return t}e.clone=o.clone,e.fromValues=o.fromValues,e.copy=o.copy,e.set=o.set,e.add=o.add,e.mul=c,e.scale=o.scale,e.dot=o.dot,e.lerp=o.lerp;var f,p,m,v,M,y,g=e.length=o.length,b=(e.len=g,e.squaredLength=o.squaredLength),w=(e.sqrLen=b,e.normalize=o.normalize);e.exactEquals=o.exactEquals,e.equals=o.equals,e.rotationTo=(f=s.create(),p=s.fromValues(1,0,0),m=s.fromValues(0,1,0),function(t,e,n){var i=s.dot(e,n);return i<-.999999?(s.cross(f,p,e),s.len(f)<1e-6&&s.cross(f,m,e),s.normalize(f,f),u(t,f,Math.PI),t):i>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(s.cross(f,e,n),t[0]=f[0],t[1]=f[1],t[2]=f[2],t[3]=1+i,w(t,t))}),e.sqlerp=(v=h(),M=h(),function(t,e,n,i,r,s){return l(v,e,r,s),l(M,n,i,s),l(t,v,M,2*s*(1-s)),t}),e.setAxes=(y=r.create(),function(t,e,n,i){return y[0]=n[0],y[3]=n[1],y[6]=n[2],y[1]=i[0],y[4]=i[1],y[7]=i[2],y[2]=-e[0],y[5]=-e[1],y[8]=-e[2],w(t,d(t,y))})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.forEach=e.sqrLen=e.sqrDist=e.dist=e.div=e.mul=e.sub=e.len=void 0,e.create=r,e.clone=function(t){var e=new i.ARRAY_TYPE(2);return e[0]=t[0],e[1]=t[1],e},e.fromValues=function(t,e){var n=new i.ARRAY_TYPE(2);return n[0]=t,n[1]=e,n},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},e.set=function(t,e,n){return t[0]=e,t[1]=n,t},e.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t},e.subtract=s,e.multiply=o,e.divide=a,e.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t},e.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t},e.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t},e.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t},e.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t},e.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t},e.scaleAndAdd=function(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t},e.distance=h,e.squaredDistance=u,e.length=c,e.squaredLength=l,e.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},e.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t},e.normalize=function(t,e){var n=e[0],i=e[1],r=n*n+i*i;r>0&&(r=1/Math.sqrt(r),t[0]=e[0]*r,t[1]=e[1]*r);return t},e.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},e.cross=function(t,e,n){var i=e[0]*n[1]-e[1]*n[0];return t[0]=t[1]=0,t[2]=i,t},e.lerp=function(t,e,n,i){var r=e[0],s=e[1];return t[0]=r+i*(n[0]-r),t[1]=s+i*(n[1]-s),t},e.random=function(t,e){e=e||1;var n=2*i.RANDOM()*Math.PI;return t[0]=Math.cos(n)*e,t[1]=Math.sin(n)*e,t},e.transformMat2=function(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[2]*r,t[1]=n[1]*i+n[3]*r,t},e.transformMat2d=function(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[2]*r+n[4],t[1]=n[1]*i+n[3]*r+n[5],t},e.transformMat3=function(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[3]*r+n[6],t[1]=n[1]*i+n[4]*r+n[7],t},e.transformMat4=function(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[4]*r+n[12],t[1]=n[1]*i+n[5]*r+n[13],t},e.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]},e.equals=function(t,e){var n=t[0],r=t[1],s=e[0],o=e[1];return Math.abs(n-s)<=i.EPSILON*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(r-o)<=i.EPSILON*Math.max(1,Math.abs(r),Math.abs(o))};var i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(0));function r(){var t=new i.ARRAY_TYPE(2);return t[0]=0,t[1]=0,t}function s(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function o(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t}function a(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t}function h(t,e){var n=e[0]-t[0],i=e[1]-t[1];return Math.sqrt(n*n+i*i)}function u(t,e){var n=e[0]-t[0],i=e[1]-t[1];return n*n+i*i}function c(t){var e=t[0],n=t[1];return Math.sqrt(e*e+n*n)}function l(t){var e=t[0],n=t[1];return e*e+n*n}var d;e.len=c,e.sub=s,e.mul=o,e.div=a,e.dist=h,e.sqrDist=u,e.sqrLen=l,e.forEach=(d=r(),function(t,e,n,i,r,s){var o=void 0,a=void 0;for(e||(e=2),n||(n=0),a=i?Math.min(i*e+n,t.length):t.length,o=n;o<a;o+=e)d[0]=t[o],d[1]=t[o+1],r(d,d,s),t[o]=d[0],t[o+1]=d[1];return t})}])},t.exports=i()},function(t,e,n){"use strict";n.r(e);var i=class{static getInstance(){return this._instance||(this._instance=new this),this._instance}static deleteInstance(){delete this._instance}};class r{}r.FirstLetterLower=function(t){return t.substring(0,1).toLowerCase()+t.substring(1,t.length).toLowerCase()},r.BindIntHandler=function(t,e){var n=r.FirstLetterLower(e);t.prototype._getInt=function(t){return Math.floor(this[t])},t.prototype._setInt=function(t,e){"number"==typeof e&&(this[t]=Math.floor(e))},t.prototype._tranInt=function(t,e){"number"==typeof e&&(this[t]=Math.floor(this[t]+e))},t.prototype._multiplyInt=function(t,e){"number"==typeof e&&(this[t]=Math.floor(this[t]*e))},t.prototype._dividedInt=function(t,e){"number"==typeof e&&(this[t]=Math.floor(this[t]/e))},t.prototype["get"+e]=function(){return this._getInt(n)},t.prototype["set"+e]=function(t){return this._setInt(n,t)},t.prototype["tran"+e]=function(t){return this._tranInt(n,t)}},r.BindDirtyIntHandler=function(t,e){var n=r.FirstLetterLower(e),i="is"+[e]+"Dirty";t.prototype._getInt=function(t){return Math.floor(this[t])},t.prototype._setInt=function(t,e){"number"==typeof e&&e!==this[t]&&(this[i]=!0,this[t]=Math.floor(e))},t.prototype._tranInt=function(t,e){"number"==typeof e&&e!==this[t]&&(this[i]=!0,this[t]=Math.floor(this[t]+e))},t.prototype._multiplyInt=function(t,e){"number"==typeof e&&e!==this[t]&&(this[i]=!0,this[t]=Math.floor(this[t]*e))},t.prototype._dividedInt=function(t,e){"number"==typeof e&&e!==this[t]&&(this[i]=!0,this[t]=Math.floor(this[t]/e))},t.prototype["get"+e]=t.prototype["get"+e]||function(){return this._getInt(n)},t.prototype["set"+e]=t.prototype["set"+e]||function(t){return this._setInt(n,t)},t.prototype["tran"+e]=t.prototype["tran"+e]||function(t){return this._tranInt(n,t)},t.prototype["_done"+e+"Dirty"]=t.prototype["_done"+e+"Dirty"]||function(){this[i]=!1}},r.BindNumberHandler=function(t,e){var n=r.FirstLetterLower(e);t.prototype._getNumber=function(t){return this[t]},t.prototype._setNumber=function(t,e){"number"==typeof e&&(this[t]=e)},t.prototype._tranNumber=function(t,e){"number"==typeof e&&(this[t]+=e)},t.prototype._multiplyNumber=function(t,e){"number"==typeof e&&(this[t]*=e)},t.prototype._dividedNumber=function(t,e){"number"==typeof e&&(this[t]/=e)},t.prototype["get"+e]=function(){return this._getNumber(n)},t.prototype["set"+e]=function(t){return this._setNumber(n,t)},t.prototype["tran"+e]=function(t){return this._tranNumber(n,t)}},r.BindDirtyNumberHandler=function(t,e){var n=r.FirstLetterLower(e),i="is"+[e]+"Dirty";t.prototype._getNumber=function(t){return this[t]},t.prototype._setNumber=function(t,e){"number"==typeof e&&e!==this[t]&&(this[i]=!0,this[t]=e)},t.prototype._tranNumber=function(t,e){"number"==typeof e&&e!==this[t]&&(this[i]=!0,this[t]+=e)},t.prototype._multiplyNumber=function(t,e){"number"==typeof e&&e!==this[t]&&(this[i]=!0,this[t]*=e)},t.prototype._dividedNumber=function(t,e){"number"==typeof e&&e!==this[t]&&(this[i]=!0,this[t]/=e)},t.prototype["get"+e]=function(){return this._getNumber(n)},t.prototype["set"+e]=function(t){return this._setNumber(n,t)},t.prototype["tran"+e]=function(t){return this._tranNumber(n,t)},t.prototype["_done"+e+"Dirty"]=function(){this[i]=!1}},r.BindBoolHandler=function(t,e){var n=r.FirstLetterLower(e);t.prototype["get"+e]=function(){return!!this[n]},t.prototype["set"+e]=function(t){this[n]=!!t},t.prototype["toggle"+e]=function(t){this[n]=!t}},r.BindDirtyBoolHandler=function(t,e){var n=r.FirstLetterLower(e),i="is"+[e]+"Dirty";t.prototype["get"+e]=t.prototype["get"+e]||function(){return!!this[n]},t.prototype["set"+e]=t.prototype["set"+e]||function(t){this[i]=!0,this[n]=!!t},t.prototype["toggle"+e]=t.prototype["toggle"+e]||function(t){this[i]=!0,this[n]=!t},t.prototype["_done"+e+"Dirty"]=t.prototype["_done"+e+"Dirty"]||function(){this[i]=!1}};class s{constructor(){this.node=null,this.parent=null,this.children=[],this.hasMounted=!1,this.enable=!0}addChild(t){return!t instanceof s?console.warn('"FI_Component.addChild" fail, this is not a FI_Component!'):null!==t.parent?console.warn('"FI_Component.addChild" fail, this component has been added!'):(this.children.push(t),t.parent=this,this.hasMounted&&t._tryToMount(),t)}setEnable(t){if(this.enable===!!t)return!0;this.enable=!!t,this.enable?this._onEnable():this._onDisable()}_tryToMount(){this.hasMounted||(this._tryToSetNode(this.parent.node),this._onMount())}_tryToSetNode(t){this.node||this._setNode(t)}_onMount(){this.hasMounted=!0,this._mountAllChildren(),this.onMount&&this.onMount()}_onUnmount(){this.hasMounted=!1,this.onUnmount&&this.onUnmount()}_onDisable(){this.onDisable&&this.onDisable()}_onEnable(){this.onEnable&&this.onEnable()}_mountAllChildren(){this.children.map(t=>t._tryToMount())}_setNode(t){return!t instanceof o?console.warn("FI_Component","can not mount on invaild node! node:",t):(this.node=t,t)}_onUpdate(t){return!1!==this.enable&&(this.children.map(e=>e._onUpdate(t)),!0)}_onRender(t){return!1!==this.enable&&(this.children.map(e=>e._onRender(t)),!0)}debugDraw(){}}class o extends r{constructor(){super(),this.children=[],this.components=[],this.actions=[],this.level=0,this.parent=null,this.enable=!0,this.visible=1,this.hasAdded=!1}addComponent(t){if(!(!t instanceof s))return this.components.push(t),t._setNode(this),this.hasAdded&&t._onMount(),t;console.log('"addComponent fail! This is not a component! "')}removeComponent(t){for(var e=0;e<this.components.length;++e)if(this.components[e]==t)return this.components.splice(e,1),void(t.hasMounted&&t._onUnmount())}setEnable(t){if(this.enable===!!t)return!0;this.enable=!!t,this.enable?this._onEnable():this._onDisable()}addChild(t){return t.parent?console.warn("has been added !"):(this.children.push(t),t.parent=this,t.setLevel(this.level+1),t._onAdded(),t)}removeChild(t){for(var e=0;e<this.children.length;++e)if(this.children[e]==t)return void this.children.splice(e,1).onRemoved()}_onAdded(){this.hasAdded=!0,this._mountAllComponent(),this.onAdded&&this.onAdded()}_onRemoved(){this.hasAdded=!1,this._removeAllComponents(),this.onRemoved&&this.onRemoved()}_onUpdate(t){return!!this.enable&&(this.onUpdate&&this.onUpdate(t),this.components.map(e=>e._onUpdate(t)),this.children.map(e=>e._onUpdate(t)),!0)}_onRender(t){this.onRender&&this.onRender(t)}_onEnable(){this.onEnable&&this.onEnable()}_onDisable(){this.onDisable&&this.onDisable()}_mountAllComponent(){this.components.map(t=>!t.hasMounted&&t._onMount())}_removeAllComponents(){this.components.map(t=>t.hasMounted&&t._onUnmount()),this.components=[]}_setAllComponentsEnable(t){this.components.map(e=>e.setEnable(t))}}r.BindDirtyIntHandler(o,"Level"),r.BindDirtyBoolHandler(o,"Enable"),r.BindDirtyBoolHandler(o,"Visible");class a extends o{static getInstance(){return this.instance||(this.instance=new a),this.instance}constructor(){super(),this.curIndex=0}run(t){this.curScene=t,this.addChild(t)}push(t){this.children[this.curIndex].setEnable(!1),this.children[this.curIndex].setVisible(!1),++this.curIndex,this.curScene=this.children[this.curIndex],this.addChild(t)}back(){}_onUpdate(t){this.curScene&&this.curScene._onUpdate(t)}_onRender(t,e){this.curScene&&this.curScene._onRender(t,e)}}var h=new a;const u=function(t){return"[object Array]"===function(t){return Object.prototype.toString.call(t)}(t)},c=function(t){var e=document.createElementNS("http://www.w3.org/2000/svg","svg"),n=e.createSVGMatrix(),i=[];t.getTransform=function(){return n};var r=t.save;t.save=function(){return i.push(n.translate(0,0)),r.call(t)};var s=t.restore;t.restore=function(){return n=i.pop(),s.call(t)};var o=t.scale;t.scale=function(e,i){return n=n.scaleNonUniform(e,i),o.call(t,e,i)};var a=t.rotate;t.rotate=function(e){return n=n.rotate(e),a.call(t,e)};var h=t.translate;t.translate=function(e,i){return n=n.translate(e,i),h.call(t,e,i)};var u=t.transform;t.transform=function(i,r,s,o,a,h){var c=e.createSVGMatrix();return c.a=i,c.b=r,c.c=s,c.d=o,c.e=a,c.f=h,n=n.multiply(c),u.call(t,i,r,s,o,a,h)};var c=t.setTransform;t.setTransform=function(e,i,r,s,o,a){return n.a=e,n.b=i,n.c=r,n.d=s,n.e=o,n.f=a,c.call(t,e,i,r,s,o,a)};var l=e.createSVGPoint();t.transformedPoint=function(t,e){return l.x=t,l.y=e,l.matrixTransform(n.inverse())};var d=e.createSVGPoint();t.transformedPoint2=function(t,e){return d.x=t,d.y=e,d.matrixTransform(n)};var f=t.clearRect;t.clearRect=function(e,n,i,r){t.save(),t.setTransform(1,0,0,1,0,0),f.call(t,e,n,i,r),t.restore()}};class l extends r{constructor(t,e){super(),this.setWidth(t),this.setHeight(e)}getWH(){return{width:this.width,height:this.height}}setWH(t,e){this._setNumber("width",t),this._setNumber("height",e)}tranWH(t,e){this._tranNumber("width",t),this._tranNumber("height",e)}assigned(t){t instanceof l&&(this.width=t.width,this.height=t.height)}copy(){return new l(this.width,this.height)}tran(){v instanceof l&&this.tranWH(v.width,v.height)}toArray(){return[this.width,this.height]}}r.BindNumberHandler(l,"Width"),r.BindNumberHandler(l,"Height"),l.BindMemberHandler=function(t,e,n){var i=r.FirstLetterLower(e),s="is"+[e]+"Dirty";n&&(e=""),t.prototype["get"+e+"Width"]=function(){return this[i].getWidth()},t.prototype["set"+e+"Width"]=function(t){return this[s]=!0,this[i].setWidth(t)},t.prototype["tran"+e+"Width"]=function(t){return this[s]=!0,this[i].tranWidth(t)},t.prototype["get"+e+"Height"]=function(){return this[i].getHeight()},t.prototype["set"+e+"Height"]=function(t){return this[s]=!0,this[i].setHeight(t)},t.prototype["tran"+e+"Height"]=function(t){return this[s]=!0,this[i].tranHeight(t)},t.prototype["_done"+e+"Dirty"]=function(){this[s]=!1}},l.BindWHHandle=function(t,e,n){var i=r.FirstLetterLower(e),s="is"+[e]+"Dirty";n&&(e=""),t.prototype["get"+e+"WH"]=function(){return this[i].getWH()},t.prototype["set"+e+"WH"]=function(t,e){return this[s]=!0,this[i].setWH(t,e)},t.prototype["tran"+e+"WH"]=function(t,e){return this[s]=!0,this[i].tranWH(t,e)},t.prototype["_done"+e+"Dirty"]=function(){this[s]=!1}},l.BindClassHandle=function(t,e,n){var i=r.FirstLetterLower(e),s="is"+[e]+"Dirty";n&&(e=""),t.prototype["get"+e]=function(){return this[i].copy()},t.prototype["set"+e]=function(t){return this[s]=!0,this[i].assigned(t)},t.prototype["tran"+e]=function(t){return this[s]=!0,this[i].tran(t)},t.prototype["_done"+e+"Dirty"]=function(){this[s]=!1}},l.BindAllHandler=function(t,e,n){l.BindMemberHandler(t,e,n),l.BindClassHandle(t,e,n),l.BindClassHandle(t,e,n)};class d extends r{constructor(t,e,n,i){super(),this.setR(t),this.setG(e),this.setB(n),this.setA(i)}assigned(t){t instanceof d&&(this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a)}copy(){return new d(this.r,this.g,this.b,this.a)}toString(){return`rgba(${Math.floor(255*this.r)},${Math.floor(255*this.g)},${Math.floor(255*this.b)},${this.a})`}toArray(){return[this.r,this.g,this.b,this.a]}}r.BindNumberHandler(d,"R"),r.BindNumberHandler(d,"G"),r.BindNumberHandler(d,"B"),r.BindNumberHandler(d,"A"),d.BindAllHandler=function(t,e,n){var i=r.FirstLetterLower(e);t.prototype["get"+e]=function(){return this[i].copy()},t.prototype["set"+e]=function(t){return this[dirtyName]=!0,this[i].assigned(t)}};var f=n(0);class p{static initShaderProgram(t,e){const n=this.loadShader(this.gl.VERTEX_SHADER,t),i=this.loadShader(this.gl.FRAGMENT_SHADER,e),r=this.gl.createProgram();return this.gl.attachShader(r,n),this.gl.attachShader(r,i),this.gl.linkProgram(r),this.gl.getProgramParameter(r,this.gl.LINK_STATUS)?r:(alert("Unable to initialize the shader program: "+this.gl.getProgramInfoLog(r)),null)}static loadShader(t,e){const n=this.gl.createShader(t);return this.gl.shaderSource(n,e),this.gl.compileShader(n),this.gl.getShaderParameter(n,this.gl.COMPILE_STATUS)?n:(alert("An error occurred compiling the shaders: "+this.gl.getShaderInfoLog(n)),this.gl.deleteShader(n),null)}static build(t){this.gl=t,this.shaderProgram=this.initShaderProgram(this.GlobalVertexShaderSource,this.GlobalFragmentShaderSource),this.attribLocations={vertexPosition:this.gl.getAttribLocation(this.shaderProgram,"aVertexPosition"),vertexColor:this.gl.getAttribLocation(this.shaderProgram,"aVertexColor")},this.uniformLocations={projectionMatrix:this.gl.getUniformLocation(this.shaderProgram,"uProjectionMatrix"),modelViewMatrix:this.gl.getUniformLocation(this.shaderProgram,"uModelViewMatrix")},this.gl.useProgram(this.shaderProgram),this.setViewPort(this.gl.canvas.clientWidth,this.gl.canvas.clientHeight)}static bindVertexPositionBuffer(t){const e=this.gl.FLOAT;this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t),this.gl.vertexAttribPointer(this.attribLocations.vertexPosition,3,e,!1,0,0),this.gl.enableVertexAttribArray(this.attribLocations.vertexPosition)}static bindVertexColorBuffer(t){const e=this.gl.FLOAT;this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t),this.gl.vertexAttribPointer(this.attribLocations.vertexColor,4,e,!1,0,0),this.gl.enableVertexAttribArray(this.attribLocations.vertexColor)}static bindVertexIndexBuffer(t){this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,t)}static uniformModelViewMatrix(t){this.gl.uniformMatrix4fv(this.uniformLocations.modelViewMatrix,!1,t)}static drawElements(t,e,n,i){this.gl.drawElements(this.gl[t],e,this.gl[n],i)}static setViewPort(t,e){this.gl.viewport(0,0,t,e)}static setUpProjection(){const t=this.gl.canvas.clientWidth/this.gl.canvas.clientHeight,e=45*Math.PI/180,n=f.mat4.create();f.mat4.perspective(n,e,t,.1,100),f.mat4.rotate(n,n,m,[0,0,1]),f.mat4.rotate(n,n,m,[0,1,0]),this.gl.uniformMatrix4fv(this.uniformLocations.projectionMatrix,!1,n),m+=.01}}var m=0;p.GlobalVertexShaderSource="\n  attribute vec4 aVertexPosition;\n  attribute vec4 aVertexColor;\n  uniform mat4 uModelViewMatrix;\n  uniform mat4 uProjectionMatrix;\n  varying lowp vec4 vColor;\n  void main() {\n    gl_Position = uProjectionMatrix * uModelViewMatrix * aVertexPosition;\n    vColor = aVertexColor;\n  }\n",p.GlobalFragmentShaderSource="\n  varying lowp vec4 vColor;\n  void main() {\n    gl_FragColor = vColor;\n  }\n";var M=p;class y{static intersectWith(t,e){var n=Math.max(t.x,e.x),i=Math.min(t.x+t.w,e.x+e.w)-n;if(i<0)return null;var r=Math.max(t.y,e.y),s=Math.min(t.y+t.h,e.y+e.h)-r;return s<0?null:new y(n,r,i,s)}constructor(t,e,n,i){this.x=t,this.y=e,this.w=n,this.h=i}intersectWith(t){return y.intersectWith(this,t)}}class g extends r{constructor(t,e){super(),this.setX(t),this.setY(e)}getXY(){return{x:this.x,y:this.y}}setXY(t,e){this._setNumber("x",t),this._setNumber("y",e)}tranXY(t,e){this._tranNumber("x",t),this._tranNumber("y",e)}assigned(t){t instanceof g&&(this.x=t.x,this.y=t.y)}copy(){return new g(this.x,this.y)}tran(){v instanceof g&&this.tranXY(v.x,v.y)}multiply(t){this.multiplyXY(t,t)}multiplyXY(t,e){this._multiplyNumber("x",t),this._multiplyNumber("y",e)}}r.BindNumberHandler(g,"X"),r.BindNumberHandler(g,"Y"),g.BindAllHandler=function(t,e,n){var i=r.FirstLetterLower(e),s="is"+[e]+"Dirty";n&&(e=""),t.prototype["get"+e+"X"]=function(){return this[i].getX()},t.prototype["set"+e+"X"]=function(t){return this[s]=!0,this[i].setX(t)},t.prototype["tran"+e+"X"]=function(t){return this[s]=!0,this[i].tranX(t)},t.prototype["get"+e+"Y"]=function(){return this[i].getY()},t.prototype["set"+e+"Y"]=function(t){return this[s]=!0,this[i].setY(t)},t.prototype["tran"+e+"Y"]=function(t){return this[s]=!0,this[i].tranY(t)},t.prototype["get"+e+"XY"]=function(){return this[i].getXY()},t.prototype["set"+e+"XY"]=function(t,e){return this[s]=!0,this[i].setXY(t,e)},t.prototype["tran"+e+"XY"]=function(t,e){return this[s]=!0,this[i].tranXY(t,e)},t.prototype["get"+e]=function(){return this[i].copy()},t.prototype["set"+e]=function(t){return this[s]=!0,this[i].assigned(t)},t.prototype["tran"+e]=function(t){return this[s]=!0,this[i].tran(t)},t.prototype["_done"+e+"Dirty"]=function(){this[s]=!1}};class b extends r{constructor(t,e,n){super(),this.setWidth(t),this.setHeight(e),this.setDepth(n)}getWHD(){return{width:this.width,height:this.height,depth:this.depth}}setWHD(t,e,n){this._setNumber("width",t),this._setNumber("height",e),this._setNumber("depth",n)}tranWHD(t,e,n){this._tranNumber("width",t),this._tranNumber("height",e),this._tranNumber("depth",n)}assigned(t){t instanceof b&&(this.width=t.width,this.height=t.height,this.depth=t.depth)}copy(){return new b(this.width,this.height,this.depth)}tran(){v instanceof b&&this.tranWH(v.width,v.height,v.depth)}toArray(){return[this.width,this.height,this.depth]}}r.BindNumberHandler(b,"Width"),r.BindNumberHandler(b,"Height"),r.BindNumberHandler(b,"Depth"),b.BindMemberHandler=function(t,e,n){var i=r.FirstLetterLower(e),s="is"+[e]+"Dirty";n&&(e=""),t.prototype["get"+e+"Width"]=function(){return this[i].getWidth()},t.prototype["set"+e+"Width"]=function(t){return this[s]=!0,this[i].setWidth(t)},t.prototype["tran"+e+"Width"]=function(t){return this[s]=!0,this[i].tranWidth(t)},t.prototype["get"+e+"Height"]=function(){return this[i].getHeight()},t.prototype["set"+e+"Height"]=function(t){return this[s]=!0,this[i].setHeight(t)},t.prototype["tran"+e+"Height"]=function(t){return this[s]=!0,this[i].tranHeight(t)},t.prototype["get"+e+"Depth"]=function(){return this[i].getDepth()},t.prototype["set"+e+"Depth"]=function(t){return this[s]=!0,this[i].setDepth(t)},t.prototype["tran"+e+"Depth"]=function(t){return this[s]=!0,this[i].tranDepth(t)},t.prototype["_done"+e+"Dirty"]=function(){this[s]=!1}},b.BindWHHandle=function(t,e,n){var i=r.FirstLetterLower(e),s="is"+[e]+"Dirty";n&&(e=""),t.prototype["get"+e+"WHD"]=function(){return this[i].getWH()},t.prototype["set"+e+"WHD"]=function(t,e,n){return this[s]=!0,this[i].setWHD(t,e,n)},t.prototype["tran"+e+"WHD"]=function(t,e,n){return this[s]=!0,this[i].tranWHD(t,e,n)},t.prototype["_done"+e+"Dirty"]=function(){this[s]=!1}},b.BindClassHandle=function(t,e,n){var i=r.FirstLetterLower(e),s="is"+[e]+"Dirty";n&&(e=""),t.prototype["get"+e]=function(){return this[i].copy()},t.prototype["set"+e]=function(t){return this[s]=!0,this[i].assigned(t)},t.prototype["tran"+e]=function(t){return this[s]=!0,this[i].tran(t)},t.prototype["_done"+e+"Dirty"]=function(){this[s]=!1}},b.BindAllHandler=function(t,e,n){b.BindMemberHandler(t,e,n),b.BindClassHandle(t,e,n),b.BindClassHandle(t,e,n)};class w extends r{constructor(t,e,n){super(),this.setX(t),this.setY(e),this.setZ(n)}setXYZ(t,e,n){this._setNumber("x",t),this._setNumber("y",e),this._setNumber("z",n)}tranXYZ(t,e,n){this._tranNumber("x",t),this._tranNumber("y",e),this._tranNumber("z",n)}assigned(t){t instanceof w&&(this.x=t.x,this.y=t.y,this.z=t.y)}copy(){return new w(this.x,this.y,this.z)}tran(){v instanceof w&&this.tranXYZ(v.x,v.y,v.z)}multiply(t){this.multiplyXYZ(t,t,t)}multiplyXYZ(t,e,n){this._multiplyNumber("x",t),this._multiplyNumber("y",e),this._multiplyNumber("z",n)}toSize(){return new b(this.x,this.y,this.z)}toObject(){return{x:this.x,y:this.y,z:this.z}}toString(){return`Vector3D(${this.x},${this.y},${this.z})`}toArray(){return[this.x,this.y,this.z]}}r.BindNumberHandler(w,"X"),r.BindNumberHandler(w,"Y"),r.BindNumberHandler(w,"Z"),w.BindAllHandler=function(t,e,n){var i=r.FirstLetterLower(e),s="is"+[e]+"Dirty";n&&(e=""),t.prototype["get"+e+"X"]=function(){return this[i].getX()},t.prototype["set"+e+"X"]=function(t){return this[s]=!0,this[i].setX(t)},t.prototype["tran"+e+"X"]=function(t){return this[s]=!0,this[i].tranX(t)},t.prototype["get"+e+"Y"]=function(){return this[i].getY()},t.prototype["set"+e+"Y"]=function(t){return this[s]=!0,this[i].setY(t)},t.prototype["tran"+e+"Y"]=function(t){return this[s]=!0,this[i].tranY(t)},t.prototype["get"+e+"Z"]=function(){return this[i].getZ()},t.prototype["set"+e+"Z"]=function(t){return this[s]=!0,this[i].setZ(t)},t.prototype["tran"+e+"Z"]=function(t){return this[s]=!0,this[i].tranZ(t)},t.prototype["get"+e+"XYZ"]=function(){return this[i].getXYZ()},t.prototype["set"+e+"XYZ"]=function(t,e,n){return this[s]=!0,this[i].setXYZ(t,e,n)},t.prototype["tran"+e+"XYZ"]=function(t,e,n){return this[s]=!0,this[i].tranXYZ(t,e,n)},t.prototype["get"+e]=function(){return this[i].copy()},t.prototype["set"+e]=function(t){return this[s]=!0,this[i].assigned(t)},t.prototype["tran"+e]=function(t){return this[s]=!0,this[i].tran(t)},t.prototype["_done"+e+"Dirty"]=function(){this[s]=!1}};const x=y,_=g,A=l,S=w;class P extends o{constructor(){super(),this.matrix=f.mat4.create(),this.position=new S(0,0,0),this.scale=new S(1,1,1)}_onUpdate(t){this.children.map(e=>e._onUpdate(t))}_onRender(t){var e=null;e=this.parent?this.parent.matrix:f.mat4.create(),f.mat4.translate(this.matrix,e,this.position.toArray()),f.mat4.scale(this.matrix,this.matrix,this.scale.toArray()),M.uniformModelViewMatrix(this.matrix),this.onRender&&this.onRender(t),this.children.map(e=>e._onRender(t))}}S.BindAllHandler(P,"Position"),S.BindAllHandler(P,"Scale");class R extends P{constructor(){super(),this.vertixPositions=[-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1];var t=[[1,1,1,1],[1,0,0,1],[0,1,0,1],[0,0,1,1],[1,1,0,1],[1,0,1,1]];this.vertixColors=[];for(var e=0;e<t.length;++e){const n=t[e];this.vertixColors=this.vertixColors.concat(n,n,n,n)}}initBuffers(t){const e=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,e),t.bufferData(t.ARRAY_BUFFER,new Float32Array(this.vertixPositions),t.STATIC_DRAW);const n=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,n),t.bufferData(t.ARRAY_BUFFER,new Float32Array(this.vertixColors),t.STATIC_DRAW);const i=t.createBuffer();t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,i);return t.bufferData(t.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),t.STATIC_DRAW),this.buffers={position:e,color:n,indices:i},this.buffers}onRender(t){!this.buffers&&this.initBuffers(t),M.bindVertexPositionBuffer(this.buffers.position),M.bindVertexColorBuffer(this.buffers.color),M.bindVertexIndexBuffer(this.buffers.indices),M.drawElements("TRIANGLES",36,"UNSIGNED_SHORT",0)}}class L extends i{constructor(){super(),this.setBackgroundColor(0,0,.5),this.setSize(800,600),this.lastUpdateTime=0}getSize(){return this.size}setSize(t,e){return this.size=new l(t,e),this}setBackgroundColor(t,e,n,i=1){return this.backgroundColor=new d(t,e,n,i),this}launch(t){return this.canvas3d=document.createElement("canvas"),this.canvas3d.style.position="absolute",t.appendChild(this.canvas3d),this.webgl=this.canvas3d.getContext("webgl"),this.canvas2d=document.createElement("canvas"),this.canvas2d.style.position="absolute",t.appendChild(this.canvas2d),this.setSize(800,600),this.ctx2d=this.canvas2d.getContext("2d"),this.ctxTracker=c(this.ctx2d),M.build(this.webgl),this.looper(0),this}drawScene(t){t.clearColor(...this.backgroundColor.toArray()),t.clearDepth(1),t.enable(t.DEPTH_TEST),t.depthFunc(t.LEQUAL),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),M.setViewPort(this.size.width,this.size.height),M.setUpProjection()}looper(t){this._onUpdate(t-this.lastUpdateTime),this._onRender(),this.lastUpdateTime=t,window.requestAnimationFrame(this.looper.bind(this))}_onUpdate(t){this.canvas3d&&(this.canvas3d.width=this.size.width,this.canvas3d.height=this.size.height),this.canvas2d&&(this.canvas2d.width=this.size.width,this.canvas2d.height=this.size.height),h._onUpdate(t)}_onRender(){this.ctx2d&&this.ctx2d.clearRect(0,0,...this.size.toArray()),"2d"===this.mode?this.ctx2d&&(this.ctx2d.fillStyle=this.backgroundColor.toString(),this.ctx2d.fillRect(0,0,...this.size.toArray())):this.webgl&&this.drawScene(this.webgl),h._onRender(this.ctx2d,this.webgl)}}class D{constructor(t,e,n){this.name=t,this.func=e,this.priority=n}setEventCenter(t){this.eventCenter=t}removeSelf(){this.eventCenter&&this.eventCenter.removeListener(this)}}class E extends i{constructor(){super(),this.listeners={}}dispatch(t,e){var n=this.getListeners(t);for(var i in n)if(n[i].func(e))break}getListeners(t){return this.listeners[t]}addListener(t,e,n){var i=this.listeners[t]||[];if(i){var r=new D(t,e,n);return r.setEventCenter(this),i.push(r),i.sort((t,e)=>e.priority-t.priority),this.listeners[t]=i,r}}removeListener(t){for(var e=this.getListeners(t.name),n=0;n<e.length;++n)if(e[n]===t){e.splice(n,1);break}}_onUpdate(t){this.opUpdate&&this.opUpdate(t)}}class I extends E{constructor(){super()}launch(){document.addEventListener("keydown",this.onKeyDown.bind(this),!1),document.addEventListener("keyup",this.onKeyUp.bind(this),!1)}onKeyDown(t){this.dispatch("keydown",t)}onKeyUp(t){this.dispatch("keyup",t)}onUpdate(t){}}class N extends E{constructor(){super()}launch(){document.addEventListener("mousedown",this.onMouseDown.bind(this),!1),document.addEventListener("mouseup",this.onMouseUp.bind(this),!1),document.addEventListener("mousemove",this.onMouseMove.bind(this),!1)}onMouseDown(t){this.dispatch("mousedown",t)}onMouseUp(t){this.dispatch("mouseup",t)}onMouseMove(t){this.dispatch("mousemove",t)}}class Y{onAssign(){}onFinish(){}_setNode(t){this.node=t,this.onAssign()}_onUpdate(){}}class O extends Y{constructor(t,e){super(),this.value=t,this.duration=e,this.time=e}onAssign(){this.endValue=this.node.getRotation()+this.value,this.speed=this.value/this.duration}onFinish(){this.node.setRotation(this.endValue),this.node.removeAction(this)}_onUpdate(t){var e=this.node.getRotation();this.node.setRotation(e+this.speed*t),this.time-=t,this.time<=0&&this.onFinish()}}var C=new class{constructor(){this.images={}}firstLoadImage(t){return new Promise((e,n)=>{var i=new Image;i.src=t,i.onload=(()=>{for(var n in this.images[t])this.images[t][n].onload(i);return this.images[t]=i,e(i)}),i.onerror=(e=>{for(var i in this.images[t])this.images[t][i].onerror(e);return delete this.images[t],n(e)})})}loadImage(t){return new Promise((e,n)=>{this.images[t].push({onload:e,onerror:n})})}getImage(t){var e=this.images[t];return e?u(e)?this.loadImage(t):Promise.resolve(e):(this.images[t]=[],this.firstLoadImage(t))}};class H extends s{constructor(t){super(),this.imageUri=t,this.texRect=null,this.scale=new g(1,1),this.flap=new g(1,1)}setScale(t){this.scale=t}setFlap(t){this.flap=t}onMount(){this.imageUri&&this._loadImage(this.imageUri)}setTexRect(t){this.texRect=t}setImage(t){this.image=t}async _loadImage(t){try{this.image=await C.getImage(t),this.texRect=this.texRect||{x:0,y:0,width:this.image.width,height:this.image.height}}catch(t){console.warn(t)}}_onRender(t){if(!super._onRender(t))return!1;if(this.image&&this.texRect&&this.node){var e=this.node.getAnchorOffset();t.scale(this.scale.x*this.flap.x,this.scale.y*this.flap.y),t.drawImage(this.image,this.texRect.x,this.texRect.y,this.texRect.width,this.texRect.height,-e.x,-e.y,this.node.size.width,this.node.size.height)}return!0}}class B extends H{constructor(){super(null),this.scale=new g(1,1),this.flap=new g(1,1)}init(t,e,n){this.setDuration(e),this.setImage(t),this.setTexRect(n)}setDuration(t){this.duration=t}getDuration(){return this.duration}}class k extends s{constructor(){super(),this.curIndex=0,this.curTime=0,this.isAutoReset=!0,this.loop=0,this.curLoop=0,this.scale=new g(1,1),this.flap=new g(1,1)}setScale(t){this.scale=t,this.curFrame&&this.curFrame.setScale(t)}setFlap(t){this.flap=t,this.curFrame&&this.curFrame.setFlap(t)}play(){this.playing=!0}stop(){this.playing=!1}setAutoReset(t){this.isAutoReset=t}setLoop(t){this.loop=t}onLoopFinish(){}onFinish(){}_onUpdate(t){if(this.playing){var e=this.children[this.curIndex];if(e)if(this.curTime+=t,e._onUpdate(t),this.curTime-e.getDuration()>=0){this.curTime=0;var n=this.curIndex+1;n>=this.children.length&&(0==this.loop?n=0:this.curLoop>=this.loop?(this.curLoop+=1,n=0):(n=this.children.length-1,this.stop())),n!==this.curIndex&&(this.curIndex=n,this.curFrame=this.children[n],this.curFrame.setScale(this.scale),this.curFrame.setFlap(this.flap))}}}_onRender(t){this.curFrame&&this.curFrame._onRender(t)}}var F=new class{constructor(){this.imagesCache={}}getImage(t){return this.imagesCache[t]||(this.imagesCache[t]=new H(t)),this.imagesCache[t]}async createWithData(t){for(var e=new k,n=0;n<t.frames.length;++n){var i=t.frames[n],r=e.addChild(new B);try{var s=await C.getImage(i.image||t.image);r.init(s,i.duration||t.duration,i.rect)}catch(t){console.warn(t)}}return e.setLoop(t.loop),e}};class T extends s{constructor(){super(),this.jumpable=!1,this.walkDirection=0,this.jumpSpeed=0,this.walkSpeed=0,this.walkAcc=0,this.gavity=0,this.ground=0}jump(){this.jumpable&&this.mover.setVelocityY(this.jumpSpeed)}walk(t){this.walkDirection=t?t/Math.abs(t):0}setJumpSpeed(t){this.jumpSpeed=t}setWalkSpeed(t){this.walkSpeed=Math.abs(t)}setWalkAcc(t){this.walkAcc=Math.abs(t)}setGavity(t){this.gavity=t}setGround(t){this.ground=t}setMover(t){this.mover=t}setRect(t){this.rect=t}onMount(){this.mover&&this.mover._setNode(this.node)}_onUpdate(t){if(this.mover){this.mover._onUpdate(t);var e=this.node.getPositionY(),n=0;e<this.ground&&(n=this.mover.tranVelocityY(this.gavity)*t/1e3,this.jumpable=!1),e+n>this.ground&&(this.node.setPositionY(this.ground),this.mover.setVelocityY(0),this.jumpable=!0);var i=this.walkDirection,r=this.walkSpeed,s=this.walkAcc;if(r&&s)if(i){var o=this.mover.getVelocityX();this.mover.tranVelocityX(i*(s-Math.abs(o*s/r))),(i>0&&o<0||i<0&&o>0)&&this.mover.decayVelocityX(s)}else this.mover.decayVelocityX(s)}}}class U extends o{constructor(){super(),this.position=new _(0,0),this.anchor=new _(.5,.5),this.size=new A(0,0),this.scale=new _(1,1),this.rotation=0}getAnchorOffset(){return{x:this.anchor.x*this.size.width,y:this.anchor.y*this.size.height}}addAction(t){return this.actions.push(t),t._setNode(this),t}removeAction(t){for(var e=0;e<this.actions.length;++e)if(this.actions[e]==t)return void this.actions.splice(e,1)}removeAllActions(){this.actions=[]}_onUpdate(t){return!!super._onUpdate(t)&&(this.actions.map(e=>e._onUpdate(t)),!0)}_onRender(t){return!!this.visible&&(t.translate(this.position.x,this.position.y),t.rotate(this.rotation*Math.PI/180),t.scale(this.scale.x,this.scale.y),t.save(),this.components.map(e=>{e._onRender(t),t.restore(),t.save()}),this.children.map(e=>{e._onRender(t),t.restore(),t.save()}),t.restore(),this._doneTransformsDirty(),this._doneLevelDirty(),this._doneEnableDirty(),!0)}isTransformsDirty(){return this.isPositionDirty||this.isScaleDirty||this.isRotationDirty||this.isSizeDirty}_doneTransformsDirty(){this._donePositionDirty(),this._doneScaleDirty(),this._doneAnchorDirty(),this._doneSizeDirty()}debugDraw(t){}}_.BindAllHandler(U,"Position"),_.BindAllHandler(U,"Scale"),_.BindAllHandler(U,"Anchor"),A.BindMemberHandler(U,"Size",!0),A.BindWHHandle(U,"Size"),A.BindClassHandle(U,"Size"),r.BindDirtyNumberHandler(U,"Rotation");class q extends s{constructor(t){super(),this.content="Hello",this.anchor=new g(0,.5),this.fontSize=24,this.fontSizeUnit="px",this.fontFamily="Arial",this.textAlign="center",this.fillStyle="white",this.strokeStyle="gray",this.offset=new g(0,0),this.size=new l(0,this.fontSize)}onMount(){}_onSizeChange(t,e){this.setSizeWH(t,e),this.onSizeChange&&this.onSizeChange(this)}_onRender(t){t.fillStyle=this.fillStyle,t.strokeStyle=this.strokeStyle,t.font=this.fontSize+this.fontSizeUnit+" "+this.fontFamily,t.textAlign=this.textAlign;var e=t.measureText(this.content);e.width==this.size.width&&e.height==this.size.height||this._onSizeChange(e.width,this.fontSize),this.fillStyle&&t.fillText(this.content,this.offset.x+this.anchor.x*this.size.width,this.offset.y+this.anchor.y*this.size.height),this.strokeStyle&&t.strokeText(this.content,this.offset.x+this.anchor.x*this.size.width,this.offset.y+this.anchor.y*this.size.height)}}g.BindAllHandler(q,"Offset"),l.BindMemberHandler(q,"Size",!0),l.BindWHHandle(q,"Size"),l.BindClassHandle(q,"Size");const z=x,X=_,j=class extends o{constructor(){super(),L.getInstance().getSize(),this.inner2D=new U,this.inner2D.hasAdded=!0,this.inner3D=new P,this.inner3D.hasAdded=!0;for(var t=-1;t<2;++t)for(var e=-1;e<2;++e)for(var n=-1;n<2;++n)0==t&&t==e&&t==n||this.addChild(new R).setPositionXYZ(6*t,6*e,6*n)}goto(t){h.push(new t)}setScale(){}addChild(t){return t instanceof U?this.inner2D.addChild(t):t instanceof P?this.inner3D.addChild(t):void 0}removeChild(t){return t instanceof U?this.inner2D.removeChild(t):t instanceof P?this.inner3D.removeChild(t):void 0}_onUpdate(t){return!!super._onUpdate()&&(this.inner3D._onUpdate(t),this.inner2D._onUpdate(t),!0)}_onRender(t,e){this.inner3D._onRender(e),t.save(),this.inner2D._onRender(t),t.restore()}},V=class extends s{constructor(){super()}onMount(){this._initKeyboard()}_initKeyboard(){this.isListeningKeyboard||(this.isListeningKeyboard=!0,I.getInstance().addListener("keydown",this._onKeyDown.bind(this),!1),I.getInstance().addListener("keyup",this._onKeyUp.bind(this),!1),this.foucsingKeys={},this.plisteners={},this.klisteners={},this.rlisteners={},this.dklisteners={},this.dclisteners={},this.dckeytimess={})}_onKeyDown(t){if("number"==typeof this.foucsingKeys[t.key])switch(this.foucsingKeys[t.key]){case-1:case 0:this.foucsingKeys[t.key]=1,this.dckeytimess[t.key]&&this.dckeytimess[t.key].push(t.timeStamp)}}_onKeyUp(t){if("number"==typeof this.foucsingKeys[t.key])switch(this.foucsingKeys[t.key]){case 1:case 2:this.foucsingKeys[t.key]=0,this.dckeytimess[t.key]&&this.dckeytimess[t.key].push(t.timeStamp)}}onKeyDoubleClick(t,e){this.foucsingKeys[t]=-1,this.dclisteners[t]=e,this.dckeytimess[t]=[]}onKeyPress(t,e){this.foucsingKeys[t]=-1,this.plisteners[t]=e}onKeyRelease(t,e){this.foucsingKeys[t]=-1,this.rlisteners[t]=e}onKeyKeepPress(t,e){this.foucsingKeys[t]=-1,this.klisteners[t]=e}onDirectionKeepPress(t,e,n){this.foucsingKeys[t]=-1,this.foucsingKeys[e]=-1,this.dklisteners[t+"_"+e]=n}_onUpdate(t){if(this.isListeningKeyboard){for(var e in this.dklisteners){var n=e.split("_");this.dklisteners[e](this.foucsingKeys[n[1]]-this.foucsingKeys[n[0]],t)}for(var e in this.foucsingKeys){switch(this.foucsingKeys[e]){case 0:this.foucsingKeys[e]--,this.rlisteners[e]&&this.rlisteners[e](t);break;case 1:this.foucsingKeys[e]++,this.plisteners[e]&&this.plisteners[e](t);break;case 2:this.klisteners[e]&&this.klisteners[e](t)}this.dckeytimess[e]&&4==this.dckeytimess[e].length&&(this.dckeytimess[e][3]-this.dckeytimess[e][0]<=500&&this.dclisteners[e]&&this.dclisteners[e](),this.dckeytimess[e]=[])}}}},W=U,K=class extends s{constructor(){super(),this.items=[],this.isDirty=!0}add(t){return this.items.push(t),t}remove(t){for(var e=0;e<this.items.length;++e)if(this.items[e]===t){this.items.splice(e,1);break}}onMount(){}_onRender(t){this.isDirty=!1;var e=this.node.getAnchorOffset();this.items.map(n=>{var{fill:i,stroke:r,fillStyle:s,strokeStyle:o,width:a,close:h,style:u,type:c}=n;switch(t.fillStyle=s||"transparent",t.strokeStyle=o||"gray",t.lineWidth=a||1,t.beginPath(),c){case"lines":var{points:l}=n;l.map((n,i)=>{0===i?t.moveTo(n.x-e.x,n.y-e.y):t.lineTo(n.x-e.x,n.y-e.y)});break;case"rect":var{x:d,y:f,w:p,h:m}=n;t.rect(d-e.x,f-e.y,p,m);break;case"circle":var{x:d,y:f,r:v}=n;t.arc(d-e.x,f-e.y,v,0,2*Math.PI)}r&&t.stroke(),i&&t.fill(),h&&t.closePath()})}},Z=class extends s{onMount(){this.mousedownListener=N.getInstance().addListener("mousedown",this._onGlobalMouseDown.bind(this),this.node.getLevel()),this.mouseupListener=N.getInstance().addListener("mouseup",this._onGlobalMouseUp.bind(this),this.node.getLevel()),this.mousemoveListener=N.getInstance().addListener("mousemove",this._onGlobalMouseMove.bind(this),this.node.getLevel())}onUnmount(){this.mousedownListener.removeSelf(),this.mouseupListener.removeSelf(),this.mousemoveListener.removeSelf()}_getCurrentIsMouseOnMe(t){if(!t||!this.transform)return!1;var e=this.node.getAnchorOffset(),n=this.transform.e-e.x*this.node.scale.x,i=n+this.node.size.width*this.node.scale.x,r=this.transform.f-e.y*this.node.scale.y,s=r+this.node.size.height*this.node.scale.y;return this.mousePosition={x:-this.transform.e+t.clientX,y:-this.transform.f+t.clientY},t.clientX>=n&&t.clientX<=i&&t.clientY>=r&&t.clientY<=s}_onGlobalMouseMove(t){t&&(this._getCurrentIsMouseOnMe(t)?(!this.isMouseOnMe&&this.onMouseOut&&this.onMouseIn(this.mousePosition),this.isMouseOnMe=!0,this._onMouseMove(t)):(this.isMouseOnMe&&this.onMouseOut&&this.onMouseOut(this.mousePosition),this.isMouseOnMe=!1))}_onMouseMove(t){this.enable&&this.onMouseMove&&this.onMouseMove(this.mousePosition)}_onGlobalMouseDown(t){var e=this._getCurrentIsMouseOnMe(t);this.enable&&e&&this.onMouseDown&&this.onMouseDown(this.mousePosition)}_onGlobalMouseUp(t){var e=this._getCurrentIsMouseOnMe(t);this.enable&&e&&this.onMouseUp&&this.onMouseUp(this.mousePosition)}_onRender(t){this.debugDraw(t),this.transform=t.getTransform()}},G=q,$=H,Q=class extends s{constructor(){super(),this.velocity=new g(0,0)}getVelocity(){return this.velocity}setVelocity(t,e){this.velocity=new g(t,e)}tranVelocity(t,e){return this.velocity.x+=t,this.velocity.y+=e,this.velocity}getVelocityX(){return this.velocity.x}setVelocityX(t){return this.velocity.x=t,this.velocity.x}tranVelocityX(t){return this.velocity.x+=t,this.velocity.x}decayVelocityX(t){this.velocity.x>0?(this.velocity.x-=Math.abs(t),this.velocity.x=Math.max(0,this.velocity.x)):this.velocity.x<0&&(this.velocity.x+=Math.abs(t),this.velocity.x=Math.min(0,this.velocity.x))}getVelocityY(){return this.velocity.y}setVelocityY(t){return this.velocity.y=t,this.velocity.y}tranVelocityY(t){return this.velocity.y+=t,this.velocity.y}decayVelocityY(t){this.velocity.y>0?(this.velocity.y-=Math.abs(t),this.velocity.y=Math.max(0,this.velocity.y)):this.velocity.y<0&&(this.velocity.y+=Math.abs(t),this.velocity.y=Math.min(0,this.velocity.y))}onMount(){}_onUpdate(t){this.node.tranPositionX(this.velocity.x*t/1e3),this.node.tranPositionY(this.velocity.y*t/1e3)}_onRender(t){}},J=class extends s{constructor(){super(),this.animations={},this.scale=new g(1,1),this.flap=new g(1,1)}setScale(t){this.scale=t,this.curAnimation&&this.curAnimation.setScale(t)}setFlap(t){this.flap=t,this.curAnimation&&this.curAnimation.setFlap(t)}async addAnimationWithData(t){var e=await F.createWithData(t);this.addChild(e),this.animations[t.name]=e}playAnaimtion(t){this.animations[t]&&(this.curAnimation=this.animations[t],this.curAnimation.play(),this.curAnimation.setScale(this.scale),this.curAnimation.setFlap(this.flap))}_onUpdate(t){return!!this.enable&&(this.curAnimation&&this.curAnimation._onUpdate(t),!0)}_onRender(t){return!!this.enable&&(this.curAnimation&&this.curAnimation._onRender(t),!0)}};class tt extends Y{constructor(t,e,n){super(),this.valueX=t,this.valueY=e,this.duration=n,this.time=n}onAssign(){this.speedX=(this.valueX-this.node.getScaleX())/this.duration,this.speedY=(this.valueY-this.node.getScaleY())/this.duration}onFinish(){this.node.setScaleX(this.valueX),this.node.setScaleY(this.valueY),this.node.removeAction(this)}_onUpdate(t){this.node.tranScaleX(this.speedX*t),this.node.tranScaleY(this.speedY*t),this.time-=t,this.time<=0&&this.onFinish()}}class et extends W{constructor(t){super(),this.textContent=t}onAdded(){var t=this.addChild(new W),e=t.addChild(new W).addComponent(new G);e.content=this.textContent,e.onSizeChange=(t=>{this.size.width=t.size.width,this.size.height=t.size.height});var n=this.addComponent(new Z);n.onMouseIn=(e=>{t.removeAllActions(),t.addAction(new tt(1.1,1.1,250)),this.onMouseIn&&this.onMouseIn()}),n.onMouseOut=(e=>{t.removeAllActions(),t.addAction(new tt(1,1,250)),this.onMouseOut&&this.onMouseOut()}),n.onMouseDown=(e=>{t.removeAllActions(),t.addAction(new tt(1,1,50)),this.onMouseDown&&this.onMouseDown()}),n.onMouseUp=(e=>{t.removeAllActions(),t.addAction(new tt(1.1,1.1,50)),this.onMouseUp&&this.onMouseUp()})}}class nt extends W{constructor(){super(),this.gavity=60,this.size.width=100,this.size.height=100,this.position.x=400,this.position.y=300,this.anchor.x=.5,this.anchor.y=0;var t=new T;t.setMover(new Q),t.setRect(new z(0,0,100,100)),t.setGavity(this.gavity),t.setGround(500),t.setJumpSpeed(-1e3),t.setWalkSpeed(120),t.setWalkAcc(50),this.actor2d=this.addComponent(t),this.animator=this.addComponent(new J),this.animator.addAnimationWithData({name:"genji_standing",loop:0,duration:120,image:"../textures/template.png",frames:[{rect:{x:0,y:0,width:79,height:79}},{rect:{x:80,y:0,width:79,height:79}},{rect:{x:160,y:0,width:79,height:79}},{rect:{x:240,y:0,width:79,height:79}}]}),this.animator.addAnimationWithData({name:"genji_running",loop:0,duration:90,image:"../textures/template.png",frames:[{rect:{x:0,y:160,width:79,height:79}},{rect:{x:80,y:160,width:79,height:79}},{rect:{x:160,y:160,width:79,height:79}},{rect:{x:80,y:160,width:79,height:79}}]}),this.animator.addAnimationWithData({name:"genji_walking",loop:0,duration:120,image:"../textures/template.png",frames:[{rect:{x:320,y:0,width:79,height:79}},{rect:{x:400,y:0,width:79,height:79}},{rect:{x:480,y:0,width:79,height:79}},{rect:{x:560,y:0,width:79,height:79}},{rect:{x:480,y:0,width:79,height:79}},{rect:{x:400,y:0,width:79,height:79}}]}).then(()=>{this.animator.playAnaimtion("genji_standing")}),console.log(this.animator)}jump(){this.actor2d.jump()}walk(t){t?(this.animator.playAnaimtion("genji_walking"),this.animator.flap.x=t):this.animator.playAnaimtion("genji_standing"),this.actor2d.walk(t)}run(t){if(this.isRunning)return!1;t?(this.animator.playAnaimtion("genji_running"),this.animator.flap.x=t,this.isRunning=!0,this.actor2d.setWalkSpeed(240),this.actor2d.setWalkAcc(100)):this.animator.playAnaimtion("genji_standing"),this.actor2d.walk(t)}stopRunning(){this.isRunning=!1,this.actor2d.setWalkSpeed(120),this.actor2d.setWalkAcc(50)}onUpdate(){this.isRunning&&this.actor2d.walk(this.animator.flap.x)}}var it=document.getElementById("app");L.getInstance().launch(it).setSize(1366,768),I.getInstance().launch(),N.getInstance().launch(),h.run(new class extends j{constructor(){super(),this.gavity=60,this.speedY=0,this.pressUp=0,this.pressDown=0,this.pressRight=0,this.pressLeft=0,this.pressJump=0,this.pressAttack=0,this.pressFn=0,this.ud=0,this.lr=0}onUpdate(t){}createBullet(t){var e=new W;e.setSizeWH(25,25),e.setPosition(this.genji.getPosition()),e.addComponent(new $("../../textures/moon_1024.jpg"));var n=e.addComponent(new Q);n.tranVelocityX(1600*Math.sin(t)),n.tranVelocityY(1600*Math.cos(t)),e.addAction(new O(1e4,1e4)),console.log(e),this.addChild(e)}getShotAngle(){var t=this.ud,e=this.lr,n=90;return 1==e?1==t?n-=45:-1==t&&(n+=45):-1==e?(n=-90,1==t?n+=45:-1==t&&(n-=45)):1==t?n=0:-1==t&&(n=180),n}rightShot(){var t=this.getShotAngle();this.createBullet((t+10)*Math.PI/180),this.createBullet(t*Math.PI/180),this.createBullet((t-10)*Math.PI/180),setTimeout(()=>{this.shotting=!1},500)}leftShot(){this.count=this.count||0,this.count++;var t=this.getShotAngle();this.createBullet(t*Math.PI/180),this.count<3?setTimeout(this.leftShot.bind(this),100):setTimeout(()=>{this.shotting=!1,this.count=0},500)}onAdded(){this.stage2D=new W;var t,e=this.stage2D.addComponent(new K),n=new z(0,600,1e3,100),i=new z(10,610,900,50),r=n.intersectWith(i);e.add({type:"lines",color:"#FF0000",stroke:!0,fill:!0,width:1,points:[new X(0,0),new X(100,100),new X(100,0)]}),e.add({color:"#FF0000",stroke:!0,fill:!0,type:"rect",x:n.x,y:n.y,w:n.w,h:n.h}),e.add({color:"#FF0000",stroke:!0,fill:!0,type:"rect",x:i.x,y:i.y,w:i.w,h:i.h}),r&&e.add({color:"#00FF00",stroke:!0,fill:!0,type:"rect",x:r.x,y:r.y,w:r.w,h:r.h}),this.addChild(this.stage2D),this.genji=this.addChild(new nt),this.buttonLayer=new W,this.buttonLayer.setPositionXY(300,0),(t=new et("Sprite & Action")).setPositionXY(400,300),this.buttonLayer.addChild(t),(t=new et("Button")).setPositionXY(400,350),t.onMouseUp=(()=>{this.inner2D.setScaleXY(.8*this.inner2D.getScaleX(),1)}),this.buttonLayer.addChild(t),this.addChild(this.buttonLayer);var s=this.addComponent(new V);s.onKeyPress("k",()=>this.genji.jump()),s.onDirectionKeepPress("w","s",(t,e)=>{t/=t?Math.abs(t):1,this.ud=t}),s.onDirectionKeepPress("a","d",(t,e)=>{t/=t?Math.abs(t):1,this.genji.isRunning?this.lr==-1*t&&(this.lr=t,this.genji.stopRunning()):(this.lr=t,this.genji.walk(t))}),s.onKeyDoubleClick("a",()=>{!this.genji.isRunning&&this.genji.run(-1)}),s.onKeyDoubleClick("d",()=>{!this.genji.isRunning&&this.genji.run(1)}),s.onKeyPress("l",()=>{this.pressFn=1}),s.onKeyRelease("l",()=>{this.pressFn=1}),s.onKeyKeepPress("j",()=>{this.shotting||(this.shotting=!0,1==this.pressFn?this.rightShot():this.leftShot())})}onRemoved(){}})}]);